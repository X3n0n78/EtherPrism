(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();class Ha{constructor(){this.listeners=new Map}on(n,e){return this.listeners.has(n)||this.listeners.set(n,new Set),this.listeners.get(n).add(e),()=>this.off(n,e)}off(n,e){this.listeners.has(n)&&this.listeners.get(n).delete(e)}emit(n,e){this.listeners.has(n)&&this.listeners.get(n).forEach(r=>{try{r(e)}catch(i){console.error(`Error in EventBus listener for "${n}":`,i)}})}}const it=new Ha;class Pa{constructor(){this.state={file:null,packets:[],flows:new Map,hostnames:new Map,hiddenNodes:new Set,selected:null,filter:{timeStart:null,timeEnd:null,searchTerm:""},isProcessing:!1,appStatus:"System Active"}}setFile(n){this.state.file=n,this.state.isProcessing=!0,this.state.appStatus=`Reading ${n.name}...`,it.emit("state:updated",{key:"isProcessing",value:!0}),it.emit("status:updated",this.state.appStatus)}setPackets(n){this.state.packets=n,this.state.isProcessing=!1,this.state.appStatus=`Analysis Complete. ${n.length.toLocaleString()} packets processed.`,this.state.flows=new Map,this.state.hostnames=new Map,this.state.hiddenNodes=new Set,this.state.selected=null,this._analyzeFlows(),it.emit("data:loaded",this.state.packets),it.emit("state:updated",{key:"isProcessing",value:!1}),it.emit("status:updated",this.state.appStatus)}updateSelection(n,e){this.state.selected=e?{type:n,data:e}:null,it.emit("selection:changed",this.state.selected)}updateTimeFilter(n,e){this.state.filter.timeStart=n,this.state.filter.timeEnd=e,it.emit("filter:time",{start:n,end:e})}updateSearch(n){this.state.filter.searchTerm=n,it.emit("filter:search",n)}hideNode(n){this.state.hiddenNodes.add(n),it.emit("view:updated",{hiddenNodes:this.state.hiddenNodes})}resetHiddenNodes(){this.state.hiddenNodes.clear(),it.emit("view:updated",{hiddenNodes:this.state.hiddenNodes})}reset(){this.state.file=null,this.state.packets=[],this.state.flows.clear(),this.state.hostnames.clear(),this.state.hiddenNodes.clear(),this.state.selected=null,this.state.appStatus="System Active",it.emit("app:reset")}_analyzeFlows(){this.state.packets.forEach(n=>{if(n.ip){const e=`${n.ip.src}->${n.ip.dst}`;this.state.flows.has(e)||this.state.flows.set(e,{source:n.ip.src,target:n.ip.dst,value:0,count:0,protocolCounts:{},packets:[],appInfo:new Set});const r=this.state.flows.get(e);r.value+=n.length,r.count+=1,r.packets.push(n);const i=n.tcp?"TCP":n.udp?"UDP":"Other";r.protocolCounts[i]=(r.protocolCounts[i]||0)+1,n.app&&(r.appInfo.add(n.app.info),r.appType=n.app.type,n.app.type==="TLS"&&n.app.info.startsWith("SNI: ")&&this.state.hostnames.set(n.ip.dst,n.app.info.replace("SNI: ","")))}})}getPackets(){return this.state.packets}getFlows(){return Array.from(this.state.flows.values())}getFlowMap(){return this.state.flows}getHostnames(){return this.state.hostnames}getHiddenNodes(){return this.state.hiddenNodes}}const rt=new Pa;function le(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Ua(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function Vr(t){let n,e,r;t.length!==2?(n=le,e=(s,l)=>le(t(s),l),r=(s,l)=>t(s)-l):(n=t===le||t===Ua?t:Ya,e=t,r=t);function i(s,l,u=0,c=s.length){if(u<c){if(n(l,l)!==0)return c;do{const g=u+c>>>1;e(s[g],l)<0?u=g+1:c=g}while(u<c)}return u}function o(s,l,u=0,c=s.length){if(u<c){if(n(l,l)!==0)return c;do{const g=u+c>>>1;e(s[g],l)<=0?u=g+1:c=g}while(u<c)}return u}function a(s,l,u=0,c=s.length){const g=i(s,l,u,c-1);return g>u&&r(s[g-1],l)>-r(s[g],l)?g-1:g}return{left:i,center:a,right:o}}function Ya(){return 0}function Ra(t){return t===null?NaN:+t}const Ba=Vr(le),Xa=Ba.right;Vr(Ra).center;class qt{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const e=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=e[i],a=n+o,s=Math.abs(n)<Math.abs(o)?n-(a-o):o-(a-n);s&&(e[r++]=s),n=a}return e[r]=n,this._n=r+1,this}valueOf(){const n=this._partials;let e=this._n,r,i,o,a=0;if(e>0){for(a=n[--e];e>0&&(r=a,i=n[--e],a=r+i,o=i-(a-r),!o););e>0&&(o<0&&n[e-1]<0||o>0&&n[e-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}const Wa=Math.sqrt(50),Za=Math.sqrt(10),Ga=Math.sqrt(2);function me(t,n,e){const r=(n-t)/Math.max(0,e),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Wa?10:o>=Za?5:o>=Ga?2:1;let s,l,u;return i<0?(u=Math.pow(10,-i)/a,s=Math.round(t*u),l=Math.round(n*u),s/u<t&&++s,l/u>n&&--l,u=-u):(u=Math.pow(10,i)*a,s=Math.round(t/u),l=Math.round(n/u),s*u<t&&++s,l*u>n&&--l),l<s&&.5<=e&&e<2?me(t,n,e*2):[s,l,u]}function Oa(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const r=n<t,[i,o,a]=r?me(n,t,e):me(t,n,e);if(!(o>=i))return[];const s=o-i+1,l=new Array(s);if(r)if(a<0)for(let u=0;u<s;++u)l[u]=(o-u)/-a;else for(let u=0;u<s;++u)l[u]=(o-u)*a;else if(a<0)for(let u=0;u<s;++u)l[u]=(i+u)/-a;else for(let u=0;u<s;++u)l[u]=(i+u)*a;return l}function pr(t,n,e){return n=+n,t=+t,e=+e,me(t,n,e)[2]}function mr(t,n,e){n=+n,t=+t,e=+e;const r=n<t,i=r?pr(n,t,e):pr(t,n,e);return(r?-1:1)*(i<0?1/-i:i)}function vi(t,n){let e;if(n===void 0)for(const r of t)r!=null&&(e<r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of t)(i=n(i,++r,t))!=null&&(e<i||e===void 0&&i>=i)&&(e=i)}return e}function Va(t,n){let e;if(n===void 0)for(const r of t)r!=null&&(e>r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of t)(i=n(i,++r,t))!=null&&(e>i||e===void 0&&i>=i)&&(e=i)}return e}function*qa(t){for(const n of t)yield*n}function Do(t){return Array.from(qa(t))}function un(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=Math.max(0,Math.ceil((n-t)/e))|0,o=new Array(i);++r<i;)o[r]=t+r*e;return o}function Ka(t){return t}var Oe=1,Ve=2,yr=3,En=4,wi=1e-6;function Ja(t){return"translate("+t+",0)"}function Qa(t){return"translate(0,"+t+")"}function ja(t){return n=>+t(n)}function ts(t,n){return n=Math.max(0,t.bandwidth()-n*2)/2,t.round()&&(n=Math.round(n)),e=>+t(e)+n}function ns(){return!this.__axis}function zo(t,n){var e=[],r=null,i=null,o=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===Oe||t===En?-1:1,c=t===En||t===Ve?"x":"y",g=t===Oe||t===yr?Ja:Qa;function f(h){var y=r??(n.ticks?n.ticks.apply(n,e):n.domain()),x=i??(n.tickFormat?n.tickFormat.apply(n,e):Ka),p=Math.max(o,0)+s,m=n.range(),w=+m[0]+l,v=+m[m.length-1]+l,d=(n.bandwidth?ts:ja)(n.copy(),l),b=h.selection?h.selection():h,M=b.selectAll(".domain").data([null]),A=b.selectAll(".tick").data(y,n).order(),T=A.exit(),D=A.enter().append("g").attr("class","tick"),k=A.select("line"),N=A.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),A=A.merge(D),k=k.merge(D.append("line").attr("stroke","currentColor").attr(c+"2",u*o)),N=N.merge(D.append("text").attr("fill","currentColor").attr(c,u*p).attr("dy",t===Oe?"0em":t===yr?"0.71em":"0.32em")),h!==b&&(M=M.transition(h),A=A.transition(h),k=k.transition(h),N=N.transition(h),T=T.transition(h).attr("opacity",wi).attr("transform",function($){return isFinite($=d($))?g($+l):this.getAttribute("transform")}),D.attr("opacity",wi).attr("transform",function($){var H=this.parentNode.__axis;return g((H&&isFinite(H=H($))?H:d($))+l)})),T.remove(),M.attr("d",t===En||t===Ve?a?"M"+u*a+","+w+"H"+l+"V"+v+"H"+u*a:"M"+l+","+w+"V"+v:a?"M"+w+","+u*a+"V"+l+"H"+v+"V"+u*a:"M"+w+","+l+"H"+v),A.attr("opacity",1).attr("transform",function($){return g(d($)+l)}),k.attr(c+"2",u*o),N.attr(c,u*p).text(x),b.filter(ns).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Ve?"start":t===En?"end":"middle"),b.each(function(){this.__axis=d})}return f.scale=function(h){return arguments.length?(n=h,f):n},f.ticks=function(){return e=Array.from(arguments),f},f.tickArguments=function(h){return arguments.length?(e=h==null?[]:Array.from(h),f):e.slice()},f.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),f):r&&r.slice()},f.tickFormat=function(h){return arguments.length?(i=h,f):i},f.tickSize=function(h){return arguments.length?(o=a=+h,f):o},f.tickSizeInner=function(h){return arguments.length?(o=+h,f):o},f.tickSizeOuter=function(h){return arguments.length?(a=+h,f):a},f.tickPadding=function(h){return arguments.length?(s=+h,f):s},f.offset=function(h){return arguments.length?(l=+h,f):l},f}function vr(t){return zo(yr,t)}function wr(t){return zo(En,t)}var es={value:()=>{}};function bn(){for(var t=0,n=arguments.length,e={},r;t<n;++t){if(!(r=arguments[t]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new fe(e)}function fe(t){this._=t}function rs(t,n){return t.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}fe.prototype=bn.prototype={constructor:fe,on:function(t,n){var e=this._,r=rs(t+"",e),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=is(e[i],t.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<a;)if(i=(t=r[o]).type)e[i]=xi(e[i],t.name,n);else if(n==null)for(i in e)e[i]=xi(e[i],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new fe(t)},call:function(t,n){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,o;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};function is(t,n){for(var e=0,r=t.length,i;e<r;++e)if((i=t[e]).name===n)return i.value}function xi(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=es,t=t.slice(0,r).concat(t.slice(r+1));break}return e!=null&&t.push({name:n,value:e}),t}var xr="http://www.w3.org/1999/xhtml";const _i={svg:"http://www.w3.org/2000/svg",xhtml:xr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Re(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),_i.hasOwnProperty(n)?{space:_i[n],local:t}:t}function os(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===xr&&n.documentElement.namespaceURI===xr?n.createElement(t):n.createElementNS(e,t)}}function as(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Lo(t){var n=Re(t);return(n.local?as:os)(n)}function ss(){}function qr(t){return t==null?ss:function(){return this.querySelector(t)}}function us(t){typeof t!="function"&&(t=qr(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,s=r[i]=new Array(a),l,u,c=0;c<a;++c)(l=o[c])&&(u=t.call(l,l.__data__,c,o))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new vt(r,this._parents)}function cs(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ls(){return[]}function Fo(t){return t==null?ls:function(){return this.querySelectorAll(t)}}function fs(t){return function(){return cs(t.apply(this,arguments))}}function hs(t){typeof t=="function"?t=fs(t):t=Fo(t);for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a=n[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&(r.push(t.call(l,l.__data__,u,a)),i.push(l));return new vt(r,i)}function Ho(t){return function(){return this.matches(t)}}function Po(t){return function(n){return n.matches(t)}}var gs=Array.prototype.find;function ds(t){return function(){return gs.call(this.children,t)}}function ps(){return this.firstElementChild}function ms(t){return this.select(t==null?ps:ds(typeof t=="function"?t:Po(t)))}var ys=Array.prototype.filter;function vs(){return Array.from(this.children)}function ws(t){return function(){return ys.call(this.children,t)}}function xs(t){return this.selectAll(t==null?vs:ws(typeof t=="function"?t:Po(t)))}function _s(t){typeof t!="function"&&(t=Ho(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new vt(r,this._parents)}function Uo(t){return new Array(t.length)}function Ms(){return new vt(this._enter||this._groups.map(Uo),this._parents)}function ye(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}ye.prototype={constructor:ye,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function bs(t){return function(){return t}}function Cs(t,n,e,r,i,o){for(var a=0,s,l=n.length,u=o.length;a<u;++a)(s=n[a])?(s.__data__=o[a],r[a]=s):e[a]=new ye(t,o[a]);for(;a<l;++a)(s=n[a])&&(i[a]=s)}function Ss(t,n,e,r,i,o,a){var s,l,u=new Map,c=n.length,g=o.length,f=new Array(c),h;for(s=0;s<c;++s)(l=n[s])&&(f[s]=h=a.call(l,l.__data__,s,n)+"",u.has(h)?i[s]=l:u.set(h,l));for(s=0;s<g;++s)h=a.call(t,o[s],s,o)+"",(l=u.get(h))?(r[s]=l,l.__data__=o[s],u.delete(h)):e[s]=new ye(t,o[s]);for(s=0;s<c;++s)(l=n[s])&&u.get(f[s])===l&&(i[s]=l)}function As(t){return t.__data__}function Ts(t,n){if(!arguments.length)return Array.from(this,As);var e=n?Ss:Cs,r=this._parents,i=this._groups;typeof t!="function"&&(t=bs(t));for(var o=i.length,a=new Array(o),s=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],g=i[u],f=g.length,h=Is(t.call(c,c&&c.__data__,u,r)),y=h.length,x=s[u]=new Array(y),p=a[u]=new Array(y),m=l[u]=new Array(f);e(c,g,x,p,m,h,n);for(var w=0,v=0,d,b;w<y;++w)if(d=x[w]){for(w>=v&&(v=w+1);!(b=p[v])&&++v<y;);d._next=b||null}}return a=new vt(a,r),a._enter=s,a._exit=l,a}function Is(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ns(){return new vt(this._exit||this._groups.map(Uo),this._parents)}function Es(t,n,e){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),n!=null&&(i=n(i),i&&(i=i.selection())),e==null?o.remove():e(o),r&&i?r.merge(i).order():i}function ks(t){for(var n=t.selection?t.selection():t,e=this._groups,r=n._groups,i=e.length,o=r.length,a=Math.min(i,o),s=new Array(i),l=0;l<a;++l)for(var u=e[l],c=r[l],g=u.length,f=s[l]=new Array(g),h,y=0;y<g;++y)(h=u[y]||c[y])&&(f[y]=h);for(;l<i;++l)s[l]=e[l];return new vt(s,this._parents)}function $s(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r=t[n],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Ds(t){t||(t=zs);function n(g,f){return g&&f?t(g.__data__,f.__data__):!g-!f}for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a=e[o],s=a.length,l=i[o]=new Array(s),u,c=0;c<s;++c)(u=a[c])&&(l[c]=u);l.sort(n)}return new vt(i,this._parents).order()}function zs(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Ls(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Fs(){return Array.from(this)}function Hs(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Ps(){let t=0;for(const n of this)++t;return t}function Us(){return!this.node()}function Ys(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i=n[e],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Rs(t){return function(){this.removeAttribute(t)}}function Bs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Xs(t,n){return function(){this.setAttribute(t,n)}}function Ws(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function Zs(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function Gs(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function Os(t,n){var e=Re(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((n==null?e.local?Bs:Rs:typeof n=="function"?e.local?Gs:Zs:e.local?Ws:Xs)(e,n))}function Yo(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Vs(t){return function(){this.style.removeProperty(t)}}function qs(t,n,e){return function(){this.style.setProperty(t,n,e)}}function Ks(t,n,e){return function(){var r=n.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}function Js(t,n,e){return arguments.length>1?this.each((n==null?Vs:typeof n=="function"?Ks:qs)(t,n,e??"")):pn(this.node(),t)}function pn(t,n){return t.style.getPropertyValue(n)||Yo(t).getComputedStyle(t,null).getPropertyValue(n)}function Qs(t){return function(){delete this[t]}}function js(t,n){return function(){this[t]=n}}function tu(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function nu(t,n){return arguments.length>1?this.each((n==null?Qs:typeof n=="function"?tu:js)(t,n)):this.node()[t]}function Ro(t){return t.trim().split(/^|\s+/)}function Kr(t){return t.classList||new Bo(t)}function Bo(t){this._node=t,this._names=Ro(t.getAttribute("class")||"")}Bo.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Xo(t,n){for(var e=Kr(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function Wo(t,n){for(var e=Kr(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function eu(t){return function(){Xo(this,t)}}function ru(t){return function(){Wo(this,t)}}function iu(t,n){return function(){(n.apply(this,arguments)?Xo:Wo)(this,t)}}function ou(t,n){var e=Ro(t+"");if(arguments.length<2){for(var r=Kr(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each((typeof n=="function"?iu:n?eu:ru)(e,n))}function au(){this.textContent=""}function su(t){return function(){this.textContent=t}}function uu(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function cu(t){return arguments.length?this.each(t==null?au:(typeof t=="function"?uu:su)(t)):this.node().textContent}function lu(){this.innerHTML=""}function fu(t){return function(){this.innerHTML=t}}function hu(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function gu(t){return arguments.length?this.each(t==null?lu:(typeof t=="function"?hu:fu)(t)):this.node().innerHTML}function du(){this.nextSibling&&this.parentNode.appendChild(this)}function pu(){return this.each(du)}function mu(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function yu(){return this.each(mu)}function vu(t){var n=typeof t=="function"?t:Lo(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function wu(){return null}function xu(t,n){var e=typeof t=="function"?t:Lo(t),r=n==null?wu:typeof n=="function"?n:qr(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})}function _u(){var t=this.parentNode;t&&t.removeChild(this)}function Mu(){return this.each(_u)}function bu(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Cu(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Su(t){return this.select(t?Cu:bu)}function Au(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Tu(t){return function(n){t.call(this,n,this.__data__)}}function Iu(t){return t.trim().split(/^|\s+/).map(function(n){var e="",r=n.indexOf(".");return r>=0&&(e=n.slice(r+1),n=n.slice(0,r)),{type:n,name:e}})}function Nu(t){return function(){var n=this.__on;if(n){for(var e=0,r=-1,i=n.length,o;e<i;++e)o=n[e],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):n[++r]=o;++r?n.length=r:delete this.__on}}}function Eu(t,n,e){return function(){var r=this.__on,i,o=Tu(n);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=e),i.value=n;return}}this.addEventListener(t.type,o,e),i={type:t.type,name:t.name,value:n,listener:o,options:e},r?r.push(i):this.__on=[i]}}function ku(t,n,e){var r=Iu(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(i=0,c=s[l];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(s=n?Eu:Nu,i=0;i<o;++i)this.each(s(r[i],n,e));return this}function Zo(t,n,e){var r=Yo(t),i=r.CustomEvent;typeof i=="function"?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}function $u(t,n){return function(){return Zo(this,t,n)}}function Du(t,n){return function(){return Zo(this,t,n.apply(this,arguments))}}function zu(t,n){return this.each((typeof n=="function"?Du:$u)(t,n))}function*Lu(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Go=[null];function vt(t,n){this._groups=t,this._parents=n}function On(){return new vt([[document.documentElement]],Go)}function Fu(){return this}vt.prototype=On.prototype={constructor:vt,select:us,selectAll:hs,selectChild:ms,selectChildren:xs,filter:_s,data:Ts,enter:Ms,exit:Ns,join:Es,merge:ks,selection:Fu,order:$s,sort:Ds,call:Ls,nodes:Fs,node:Hs,size:Ps,empty:Us,each:Ys,attr:Os,style:Js,property:nu,classed:ou,text:cu,html:gu,raise:pu,lower:yu,append:vu,insert:xu,remove:Mu,clone:Su,datum:Au,on:ku,dispatch:zu,[Symbol.iterator]:Lu};function ot(t){return typeof t=="string"?new vt([[document.querySelector(t)]],[document.documentElement]):new vt([[t]],Go)}function Hu(t){let n;for(;n=t.sourceEvent;)t=n;return t}function Ct(t,n){if(t=Hu(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}}return[t.pageX,t.pageY]}const Pu={passive:!1},Yn={capture:!0,passive:!1};function qe(t){t.stopImmediatePropagation()}function hn(t){t.preventDefault(),t.stopImmediatePropagation()}function Jr(t){var n=t.document.documentElement,e=ot(t).on("dragstart.drag",hn,Yn);"onselectstart"in n?e.on("selectstart.drag",hn,Yn):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Qr(t,n){var e=t.document.documentElement,r=ot(t).on("dragstart.drag",null);n&&(r.on("click.drag",hn,Yn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}const Jn=t=>()=>t;function _r(t,{sourceEvent:n,subject:e,target:r,identifier:i,active:o,x:a,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}_r.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Uu(t){return!t.ctrlKey&&!t.button}function Yu(){return this.parentNode}function Ru(t,n){return n??{x:t.x,y:t.y}}function Bu(){return navigator.maxTouchPoints||"ontouchstart"in this}function Xu(){var t=Uu,n=Yu,e=Ru,r=Bu,i={},o=bn("start","drag","end"),a=0,s,l,u,c,g=0;function f(d){d.on("mousedown.drag",h).filter(r).on("touchstart.drag",p).on("touchmove.drag",m,Pu).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(d,b){if(!(c||!t.call(this,d,b))){var M=v(this,n.call(this,d,b),d,b,"mouse");M&&(ot(d.view).on("mousemove.drag",y,Yn).on("mouseup.drag",x,Yn),Jr(d.view),qe(d),u=!1,s=d.clientX,l=d.clientY,M("start",d))}}function y(d){if(hn(d),!u){var b=d.clientX-s,M=d.clientY-l;u=b*b+M*M>g}i.mouse("drag",d)}function x(d){ot(d.view).on("mousemove.drag mouseup.drag",null),Qr(d.view,u),hn(d),i.mouse("end",d)}function p(d,b){if(t.call(this,d,b)){var M=d.changedTouches,A=n.call(this,d,b),T=M.length,D,k;for(D=0;D<T;++D)(k=v(this,A,d,b,M[D].identifier,M[D]))&&(qe(d),k("start",d,M[D]))}}function m(d){var b=d.changedTouches,M=b.length,A,T;for(A=0;A<M;++A)(T=i[b[A].identifier])&&(hn(d),T("drag",d,b[A]))}function w(d){var b=d.changedTouches,M=b.length,A,T;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),A=0;A<M;++A)(T=i[b[A].identifier])&&(qe(d),T("end",d,b[A]))}function v(d,b,M,A,T,D){var k=o.copy(),N=Ct(D||M,b),$,H,_;if((_=e.call(d,new _r("beforestart",{sourceEvent:M,target:f,identifier:T,active:a,x:N[0],y:N[1],dx:0,dy:0,dispatch:k}),A))!=null)return $=_.x-N[0]||0,H=_.y-N[1]||0,function C(S,I,F){var z=N,L;switch(S){case"start":i[T]=C,L=a++;break;case"end":delete i[T],--a;case"drag":N=Ct(F||I,b),L=a;break}k.call(S,d,new _r(S,{sourceEvent:I,subject:_,target:f,identifier:T,active:L,x:N[0]+$,y:N[1]+H,dx:N[0]-z[0],dy:N[1]-z[1],dispatch:k}),A)}}return f.filter=function(d){return arguments.length?(t=typeof d=="function"?d:Jn(!!d),f):t},f.container=function(d){return arguments.length?(n=typeof d=="function"?d:Jn(d),f):n},f.subject=function(d){return arguments.length?(e=typeof d=="function"?d:Jn(d),f):e},f.touchable=function(d){return arguments.length?(r=typeof d=="function"?d:Jn(!!d),f):r},f.on=function(){var d=o.on.apply(o,arguments);return d===o?f:d},f.clickDistance=function(d){return arguments.length?(g=(d=+d)*d,f):Math.sqrt(g)},f}function jr(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Oo(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Vn(){}var Rn=.7,ve=1/Rn,gn="\\s*([+-]?\\d+)\\s*",Bn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Et="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wu=/^#([0-9a-f]{3,8})$/,Zu=new RegExp(`^rgb\\(${gn},${gn},${gn}\\)$`),Gu=new RegExp(`^rgb\\(${Et},${Et},${Et}\\)$`),Ou=new RegExp(`^rgba\\(${gn},${gn},${gn},${Bn}\\)$`),Vu=new RegExp(`^rgba\\(${Et},${Et},${Et},${Bn}\\)$`),qu=new RegExp(`^hsl\\(${Bn},${Et},${Et}\\)$`),Ku=new RegExp(`^hsla\\(${Bn},${Et},${Et},${Bn}\\)$`),Mi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};jr(Vn,Kt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:bi,formatHex:bi,formatHex8:Ju,formatHsl:Qu,formatRgb:Ci,toString:Ci});function bi(){return this.rgb().formatHex()}function Ju(){return this.rgb().formatHex8()}function Qu(){return Vo(this).formatHsl()}function Ci(){return this.rgb().formatRgb()}function Kt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Wu.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?Si(n):e===3?new mt(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?Qn(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?Qn(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Zu.exec(t))?new mt(n[1],n[2],n[3],1):(n=Gu.exec(t))?new mt(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Ou.exec(t))?Qn(n[1],n[2],n[3],n[4]):(n=Vu.exec(t))?Qn(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=qu.exec(t))?Ii(n[1],n[2]/100,n[3]/100,1):(n=Ku.exec(t))?Ii(n[1],n[2]/100,n[3]/100,n[4]):Mi.hasOwnProperty(t)?Si(Mi[t]):t==="transparent"?new mt(NaN,NaN,NaN,0):null}function Si(t){return new mt(t>>16&255,t>>8&255,t&255,1)}function Qn(t,n,e,r){return r<=0&&(t=n=e=NaN),new mt(t,n,e,r)}function ju(t){return t instanceof Vn||(t=Kt(t)),t?(t=t.rgb(),new mt(t.r,t.g,t.b,t.opacity)):new mt}function Mr(t,n,e,r){return arguments.length===1?ju(t):new mt(t,n,e,r??1)}function mt(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}jr(mt,Mr,Oo(Vn,{brighter(t){return t=t==null?ve:Math.pow(ve,t),new mt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Rn:Math.pow(Rn,t),new mt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new mt(Ot(this.r),Ot(this.g),Ot(this.b),we(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ai,formatHex:Ai,formatHex8:tc,formatRgb:Ti,toString:Ti}));function Ai(){return`#${Gt(this.r)}${Gt(this.g)}${Gt(this.b)}`}function tc(){return`#${Gt(this.r)}${Gt(this.g)}${Gt(this.b)}${Gt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ti(){const t=we(this.opacity);return`${t===1?"rgb(":"rgba("}${Ot(this.r)}, ${Ot(this.g)}, ${Ot(this.b)}${t===1?")":`, ${t})`}`}function we(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ot(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Gt(t){return t=Ot(t),(t<16?"0":"")+t.toString(16)}function Ii(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new At(t,n,e,r)}function Vo(t){if(t instanceof At)return new At(t.h,t.s,t.l,t.opacity);if(t instanceof Vn||(t=Kt(t)),!t)return new At;if(t instanceof At)return t;t=t.rgb();var n=t.r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,s=o-i,l=(o+i)/2;return s?(n===o?a=(e-r)/s+(e<r)*6:e===o?a=(r-n)/s+2:a=(n-e)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new At(a,s,l,t.opacity)}function nc(t,n,e,r){return arguments.length===1?Vo(t):new At(t,n,e,r??1)}function At(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}jr(At,nc,Oo(Vn,{brighter(t){return t=t==null?ve:Math.pow(ve,t),new At(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Rn:Math.pow(Rn,t),new At(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new mt(Ke(t>=240?t-240:t+120,i,r),Ke(t,i,r),Ke(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new At(Ni(this.h),jn(this.s),jn(this.l),we(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=we(this.opacity);return`${t===1?"hsl(":"hsla("}${Ni(this.h)}, ${jn(this.s)*100}%, ${jn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ni(t){return t=(t||0)%360,t<0?t+360:t}function jn(t){return Math.max(0,Math.min(1,t||0))}function Ke(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const ti=t=>()=>t;function ec(t,n){return function(e){return t+e*n}}function rc(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}function ic(t){return(t=+t)==1?qo:function(n,e){return e-n?rc(n,e,t):ti(isNaN(n)?e:n)}}function qo(t,n){var e=n-t;return e?ec(t,e):ti(isNaN(t)?n:t)}const xe=function t(n){var e=ic(n);function r(i,o){var a=e((i=Mr(i)).r,(o=Mr(o)).r),s=e(i.g,o.g),l=e(i.b,o.b),u=qo(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=s(c),i.b=l(c),i.opacity=u(c),i+""}}return r.gamma=t,r}(1);function oc(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,r=n.slice(),i;return function(o){for(i=0;i<e;++i)r[i]=t[i]*(1-o)+n[i]*o;return r}}function ac(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function sc(t,n){var e=n?n.length:0,r=t?Math.min(e,t.length):0,i=new Array(r),o=new Array(e),a;for(a=0;a<r;++a)i[a]=Be(t[a],n[a]);for(;a<e;++a)o[a]=n[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function uc(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function St(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}function cc(t,n){var e={},r={},i;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(i in n)i in t?e[i]=Be(t[i],n[i]):r[i]=n[i];return function(o){for(i in e)r[i]=e[i](o);return r}}var br=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Je=new RegExp(br.source,"g");function lc(t){return function(){return t}}function fc(t){return function(n){return t(n)+""}}function Ko(t,n){var e=br.lastIndex=Je.lastIndex=0,r,i,o,a=-1,s=[],l=[];for(t=t+"",n=n+"";(r=br.exec(t))&&(i=Je.exec(n));)(o=i.index)>e&&(o=n.slice(e,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:St(r,i)})),e=Je.lastIndex;return e<n.length&&(o=n.slice(e),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?fc(l[0].x):lc(n):(n=l.length,function(u){for(var c=0,g;c<n;++c)s[(g=l[c]).i]=g.x(u);return s.join("")})}function Be(t,n){var e=typeof n,r;return n==null||e==="boolean"?ti(n):(e==="number"?St:e==="string"?(r=Kt(n))?(n=r,xe):Ko:n instanceof Kt?xe:n instanceof Date?uc:ac(n)?oc:Array.isArray(n)?sc:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?cc:St)(t,n)}function hc(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}var Ei=180/Math.PI,Cr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Jo(t,n,e,r,i,o){var a,s,l;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(l=t*e+n*r)&&(e-=t*l,r-=n*l),(s=Math.sqrt(e*e+r*r))&&(e/=s,r/=s,l/=s),t*r<n*e&&(t=-t,n=-n,l=-l,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*Ei,skewX:Math.atan(l)*Ei,scaleX:a,scaleY:s}}var te;function gc(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?Cr:Jo(n.a,n.b,n.c,n.d,n.e,n.f)}function dc(t){return t==null||(te||(te=document.createElementNS("http://www.w3.org/2000/svg","g")),te.setAttribute("transform",t),!(t=te.transform.baseVal.consolidate()))?Cr:(t=t.matrix,Jo(t.a,t.b,t.c,t.d,t.e,t.f))}function Qo(t,n,e,r){function i(u){return u.length?u.pop()+" ":""}function o(u,c,g,f,h,y){if(u!==g||c!==f){var x=h.push("translate(",null,n,null,e);y.push({i:x-4,x:St(u,g)},{i:x-2,x:St(c,f)})}else(g||f)&&h.push("translate("+g+n+f+e)}function a(u,c,g,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:g.push(i(g)+"rotate(",null,r)-2,x:St(u,c)})):c&&g.push(i(g)+"rotate("+c+r)}function s(u,c,g,f){u!==c?f.push({i:g.push(i(g)+"skewX(",null,r)-2,x:St(u,c)}):c&&g.push(i(g)+"skewX("+c+r)}function l(u,c,g,f,h,y){if(u!==g||c!==f){var x=h.push(i(h)+"scale(",null,",",null,")");y.push({i:x-4,x:St(u,g)},{i:x-2,x:St(c,f)})}else(g!==1||f!==1)&&h.push(i(h)+"scale("+g+","+f+")")}return function(u,c){var g=[],f=[];return u=t(u),c=t(c),o(u.translateX,u.translateY,c.translateX,c.translateY,g,f),a(u.rotate,c.rotate,g,f),s(u.skewX,c.skewX,g,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,g,f),u=c=null,function(h){for(var y=-1,x=f.length,p;++y<x;)g[(p=f[y]).i]=p.x(h);return g.join("")}}}var pc=Qo(gc,"px, ","px)","deg)"),mc=Qo(dc,", ",")",")"),yc=1e-12;function ki(t){return((t=Math.exp(t))+1/t)/2}function vc(t){return((t=Math.exp(t))-1/t)/2}function wc(t){return((t=Math.exp(2*t))-1)/(t+1)}const xc=function t(n,e,r){function i(o,a){var s=o[0],l=o[1],u=o[2],c=a[0],g=a[1],f=a[2],h=c-s,y=g-l,x=h*h+y*y,p,m;if(x<yc)m=Math.log(f/u)/n,p=function(A){return[s+A*h,l+A*y,u*Math.exp(n*A*m)]};else{var w=Math.sqrt(x),v=(f*f-u*u+r*x)/(2*u*e*w),d=(f*f-u*u-r*x)/(2*f*e*w),b=Math.log(Math.sqrt(v*v+1)-v),M=Math.log(Math.sqrt(d*d+1)-d);m=(M-b)/n,p=function(A){var T=A*m,D=ki(b),k=u/(e*w)*(D*wc(n*T+b)-vc(b));return[s+k*h,l+k*y,u*D/ki(n*T+b)]}}return p.duration=m*1e3*n/Math.SQRT2,p}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,l=s*s;return t(a,s,l)},i}(Math.SQRT2,2,4);var mn=0,kn=0,Sn=0,jo=1e3,_e,$n,Me=0,Jt=0,Xe=0,Xn=typeof performance=="object"&&performance.now?performance:Date,ta=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ni(){return Jt||(ta(_c),Jt=Xn.now()+Xe)}function _c(){Jt=0}function be(){this._call=this._time=this._next=null}be.prototype=We.prototype={constructor:be,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?ni():+e)+(n==null?0:+n),!this._next&&$n!==this&&($n?$n._next=this:_e=this,$n=this),this._call=t,this._time=e,Sr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Sr())}};function We(t,n,e){var r=new be;return r.restart(t,n,e),r}function Mc(){ni(),++mn;for(var t=_e,n;t;)(n=Jt-t._time)>=0&&t._call.call(void 0,n),t=t._next;--mn}function $i(){Jt=(Me=Xn.now())+Xe,mn=kn=0;try{Mc()}finally{mn=0,Cc(),Jt=0}}function bc(){var t=Xn.now(),n=t-Me;n>jo&&(Xe-=n,Me=t)}function Cc(){for(var t,n=_e,e,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:_e=e);$n=t,Sr(r)}function Sr(t){if(!mn){kn&&(kn=clearTimeout(kn));var n=t-Jt;n>24?(t<1/0&&(kn=setTimeout($i,t-Xn.now()-Xe)),Sn&&(Sn=clearInterval(Sn))):(Sn||(Me=Xn.now(),Sn=setInterval(bc,jo)),mn=1,ta($i))}}function Di(t,n,e){var r=new be;return n=n==null?0:+n,r.restart(i=>{r.stop(),t(i+n)},n,e),r}var Sc=bn("start","end","cancel","interrupt"),Ac=[],na=0,zi=1,Ar=2,he=3,Li=4,Tr=5,ge=6;function Ze(t,n,e,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(e in a)return;Tc(t,e,{name:n,index:r,group:i,on:Sc,tween:Ac,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:na})}function ei(t,n){var e=Tt(t,n);if(e.state>na)throw new Error("too late; already scheduled");return e}function kt(t,n){var e=Tt(t,n);if(e.state>he)throw new Error("too late; already running");return e}function Tt(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Tc(t,n,e){var r=t.__transition,i;r[n]=e,e.timer=We(o,0,e.time);function o(u){e.state=zi,e.timer.restart(a,e.delay,e.time),e.delay<=u&&a(u-e.delay)}function a(u){var c,g,f,h;if(e.state!==zi)return l();for(c in r)if(h=r[c],h.name===e.name){if(h.state===he)return Di(a);h.state===Li?(h.state=ge,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete r[c]):+c<n&&(h.state=ge,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete r[c])}if(Di(function(){e.state===he&&(e.state=Li,e.timer.restart(s,e.delay,e.time),s(u))}),e.state=Ar,e.on.call("start",t,t.__data__,e.index,e.group),e.state===Ar){for(e.state=he,i=new Array(f=e.tween.length),c=0,g=-1;c<f;++c)(h=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(i[++g]=h);i.length=g+1}}function s(u){for(var c=u<e.duration?e.ease.call(null,u/e.duration):(e.timer.restart(l),e.state=Tr,1),g=-1,f=i.length;++g<f;)i[g].call(t,c);e.state===Tr&&(e.on.call("end",t,t.__data__,e.index,e.group),l())}function l(){e.state=ge,e.timer.stop(),delete r[n];for(var u in r)return;delete t.__transition}}function dn(t,n){var e=t.__transition,r,i,o=!0,a;if(e){n=n==null?null:n+"";for(a in e){if((r=e[a]).name!==n){o=!1;continue}i=r.state>Ar&&r.state<Tr,r.state=ge,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete e[a]}o&&delete t.__transition}}function Ic(t){return this.each(function(){dn(this,t)})}function Nc(t,n){var e,r;return function(){var i=kt(this,t),o=i.tween;if(o!==e){r=e=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===n){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Ec(t,n,e){var r,i;if(typeof e!="function")throw new Error;return function(){var o=kt(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:n,value:e},l=0,u=i.length;l<u;++l)if(i[l].name===n){i[l]=s;break}l===u&&i.push(s)}o.tween=i}}function kc(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r=Tt(this.node(),e).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((n==null?Nc:Ec)(e,t,n))}function ri(t,n,e){var r=t._id;return t.each(function(){var i=kt(this,r);(i.value||(i.value={}))[n]=e.apply(this,arguments)}),function(i){return Tt(i,r).value[n]}}function ea(t,n){var e;return(typeof n=="number"?St:n instanceof Kt?xe:(e=Kt(n))?(n=e,xe):Ko)(t,n)}function $c(t){return function(){this.removeAttribute(t)}}function Dc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zc(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=n(r=a,e)}}function Lc(t,n,e){var r,i=e+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=n(r=a,e)}}function Fc(t,n,e){var r,i,o;return function(){var a,s=e(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=n(r=a,s)))}}function Hc(t,n,e){var r,i,o;return function(){var a,s=e(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===r&&l===i?o:(i=l,o=n(r=a,s)))}}function Pc(t,n){var e=Re(t),r=e==="transform"?mc:ea;return this.attrTween(t,typeof n=="function"?(e.local?Hc:Fc)(e,r,ri(this,"attr."+t,n)):n==null?(e.local?Dc:$c)(e):(e.local?Lc:zc)(e,r,n))}function Uc(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function Yc(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function Rc(t,n){var e,r;function i(){var o=n.apply(this,arguments);return o!==r&&(e=(r=o)&&Yc(t,o)),e}return i._value=n,i}function Bc(t,n){var e,r;function i(){var o=n.apply(this,arguments);return o!==r&&(e=(r=o)&&Uc(t,o)),e}return i._value=n,i}function Xc(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var r=Re(t);return this.tween(e,(r.local?Rc:Bc)(r,n))}function Wc(t,n){return function(){ei(this,t).delay=+n.apply(this,arguments)}}function Zc(t,n){return n=+n,function(){ei(this,t).delay=n}}function Gc(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Wc:Zc)(n,t)):Tt(this.node(),n).delay}function Oc(t,n){return function(){kt(this,t).duration=+n.apply(this,arguments)}}function Vc(t,n){return n=+n,function(){kt(this,t).duration=n}}function qc(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Oc:Vc)(n,t)):Tt(this.node(),n).duration}function Kc(t,n){if(typeof n!="function")throw new Error;return function(){kt(this,t).ease=n}}function Jc(t){var n=this._id;return arguments.length?this.each(Kc(n,t)):Tt(this.node(),n).ease}function Qc(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;kt(this,t).ease=e}}function jc(t){if(typeof t!="function")throw new Error;return this.each(Qc(this._id,t))}function tl(t){typeof t!="function"&&(t=Ho(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o=n[i],a=o.length,s=r[i]=[],l,u=0;u<a;++u)(l=o[u])&&t.call(l,l.__data__,u,o)&&s.push(l);return new Ut(r,this._parents,this._name,this._id)}function nl(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var l=n[s],u=e[s],c=l.length,g=a[s]=new Array(c),f,h=0;h<c;++h)(f=l[h]||u[h])&&(g[h]=f);for(;s<r;++s)a[s]=n[s];return new Ut(a,this._parents,this._name,this._id)}function el(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function rl(t,n,e){var r,i,o=el(n)?ei:kt;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(n,e),a.on=i}}function il(t,n){var e=this._id;return arguments.length<2?Tt(this.node(),e).on.on(t):this.each(rl(e,t,n))}function ol(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function al(){return this.on("end.remove",ol(this._id))}function sl(t){var n=this._name,e=this._id;typeof t!="function"&&(t=qr(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],l=s.length,u=o[a]=new Array(l),c,g,f=0;f<l;++f)(c=s[f])&&(g=t.call(c,c.__data__,f,s))&&("__data__"in c&&(g.__data__=c.__data__),u[f]=g,Ze(u[f],n,e,f,u,Tt(c,e)));return new Ut(o,this._parents,n,e)}function ul(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Fo(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var l=r[s],u=l.length,c,g=0;g<u;++g)if(c=l[g]){for(var f=t.call(c,c.__data__,g,l),h,y=Tt(c,e),x=0,p=f.length;x<p;++x)(h=f[x])&&Ze(h,n,e,x,f,y);o.push(f),a.push(c)}return new Ut(o,a,n,e)}var cl=On.prototype.constructor;function ll(){return new cl(this._groups,this._parents)}function fl(t,n){var e,r,i;return function(){var o=pn(this,t),a=(this.style.removeProperty(t),pn(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}function ra(t){return function(){this.style.removeProperty(t)}}function hl(t,n,e){var r,i=e+"",o;return function(){var a=pn(this,t);return a===i?null:a===r?o:o=n(r=a,e)}}function gl(t,n,e){var r,i,o;return function(){var a=pn(this,t),s=e(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),pn(this,t))),a===l?null:a===r&&l===i?o:(i=l,o=n(r=a,s))}}function dl(t,n){var e,r,i,o="style."+n,a="end."+o,s;return function(){var l=kt(this,t),u=l.on,c=l.value[o]==null?s||(s=ra(n)):void 0;(u!==e||i!==c)&&(r=(e=u).copy()).on(a,i=c),l.on=r}}function pl(t,n,e){var r=(t+="")=="transform"?pc:ea;return n==null?this.styleTween(t,fl(t,r)).on("end.style."+t,ra(t)):typeof n=="function"?this.styleTween(t,gl(t,r,ri(this,"style."+t,n))).each(dl(this._id,t)):this.styleTween(t,hl(t,r,n),e).on("end.style."+t,null)}function ml(t,n,e){return function(r){this.style.setProperty(t,n.call(this,r),e)}}function yl(t,n,e){var r,i;function o(){var a=n.apply(this,arguments);return a!==i&&(r=(i=a)&&ml(t,a,e)),r}return o._value=n,o}function vl(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,yl(t,n,e??""))}function wl(t){return function(){this.textContent=t}}function xl(t){return function(){var n=t(this);this.textContent=n??""}}function _l(t){return this.tween("text",typeof t=="function"?xl(ri(this,"text",t)):wl(t==null?"":t+""))}function Ml(t){return function(n){this.textContent=t.call(this,n)}}function bl(t){var n,e;function r(){var i=t.apply(this,arguments);return i!==e&&(n=(e=i)&&Ml(i)),n}return r._value=t,r}function Cl(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,bl(t))}function Sl(){for(var t=this._name,n=this._id,e=ia(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)if(l=a[u]){var c=Tt(l,n);Ze(l,t,e,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ut(r,this._parents,t,e)}function Al(){var t,n,e=this,r=e._id,i=e.size();return new Promise(function(o,a){var s={value:a},l={value:function(){--i===0&&o()}};e.each(function(){var u=kt(this,r),c=u.on;c!==t&&(n=(t=c).copy(),n._.cancel.push(s),n._.interrupt.push(s),n._.end.push(l)),u.on=n}),i===0&&o()})}var Tl=0;function Ut(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function ia(){return++Tl}var $t=On.prototype;Ut.prototype={constructor:Ut,select:sl,selectAll:ul,selectChild:$t.selectChild,selectChildren:$t.selectChildren,filter:tl,merge:nl,selection:ll,transition:Sl,call:$t.call,nodes:$t.nodes,node:$t.node,size:$t.size,empty:$t.empty,each:$t.each,on:il,attr:Pc,attrTween:Xc,style:pl,styleTween:vl,text:_l,textTween:Cl,remove:al,tween:kc,delay:Gc,duration:qc,ease:Jc,easeVarying:jc,end:Al,[Symbol.iterator]:$t[Symbol.iterator]};function Il(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Nl={time:null,delay:0,duration:250,ease:Il};function El(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function kl(t){var n,e;t instanceof Ut?(n=t._id,t=t._name):(n=ia(),(e=Nl).time=ni(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,l,u=0;u<s;++u)(l=a[u])&&Ze(l,t,n,u,a,e||El(l,n));return new Ut(r,this._parents,t,n)}On.prototype.interrupt=Ic;On.prototype.transition=kl;const Qe=t=>()=>t;function $l(t,{sourceEvent:n,target:e,selection:r,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Dl(t){t.stopImmediatePropagation()}function je(t){t.preventDefault(),t.stopImmediatePropagation()}var Fi={name:"drag"},tr={name:"space"},rn={name:"handle"},on={name:"center"};const{abs:Hi,max:lt,min:ft}=Math;function Pi(t){return[+t[0],+t[1]]}function Ui(t){return[Pi(t[0]),Pi(t[1])]}var de={name:"x",handles:["w","e"].map(Ir),input:function(t,n){return t==null?null:[[+t[0],n[0][1]],[+t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},nr={},Dt={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Yi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Ri={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},zl={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ll={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ir(t){return{type:t}}function Fl(t){return!t.ctrlKey&&!t.button}function Hl(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Pl(){return navigator.maxTouchPoints||"ontouchstart"in this}function er(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Ul(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Yl(){return Rl(de)}function Rl(t){var n=Hl,e=Fl,r=Pl,i=!0,o=bn("start","brush","end"),a=6,s;function l(p){var m=p.property("__brush",x).selectAll(".overlay").data([Ir("overlay")]);m.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Dt.overlay).merge(m).each(function(){var v=er(this).extent;ot(this).attr("x",v[0][0]).attr("y",v[0][1]).attr("width",v[1][0]-v[0][0]).attr("height",v[1][1]-v[0][1])}),p.selectAll(".selection").data([Ir("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Dt.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var w=p.selectAll(".handle").data(t.handles,function(v){return v.type});w.exit().remove(),w.enter().append("rect").attr("class",function(v){return"handle handle--"+v.type}).attr("cursor",function(v){return Dt[v.type]}),p.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(r).on("touchstart.brush",f).on("touchmove.brush",h).on("touchend.brush touchcancel.brush",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}l.move=function(p,m,w){p.tween?p.on("start.brush",function(v){c(this,arguments).beforestart().start(v)}).on("interrupt.brush end.brush",function(v){c(this,arguments).end(v)}).tween("brush",function(){var v=this,d=v.__brush,b=c(v,arguments),M=d.selection,A=t.input(typeof m=="function"?m.apply(this,arguments):m,d.extent),T=Be(M,A);function D(k){d.selection=k===1&&A===null?null:T(k),u.call(v),b.brush()}return M!==null&&A!==null?D:D(1)}):p.each(function(){var v=this,d=arguments,b=v.__brush,M=t.input(typeof m=="function"?m.apply(v,d):m,b.extent),A=c(v,d).beforestart();dn(v),b.selection=M===null?null:M,u.call(v),A.start(w).brush(w).end(w)})},l.clear=function(p,m){l.move(p,null,m)};function u(){var p=ot(this),m=er(this).selection;m?(p.selectAll(".selection").style("display",null).attr("x",m[0][0]).attr("y",m[0][1]).attr("width",m[1][0]-m[0][0]).attr("height",m[1][1]-m[0][1]),p.selectAll(".handle").style("display",null).attr("x",function(w){return w.type[w.type.length-1]==="e"?m[1][0]-a/2:m[0][0]-a/2}).attr("y",function(w){return w.type[0]==="s"?m[1][1]-a/2:m[0][1]-a/2}).attr("width",function(w){return w.type==="n"||w.type==="s"?m[1][0]-m[0][0]+a:a}).attr("height",function(w){return w.type==="e"||w.type==="w"?m[1][1]-m[0][1]+a:a})):p.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(p,m,w){var v=p.__brush.emitter;return v&&(!w||!v.clean)?v:new g(p,m,w)}function g(p,m,w){this.that=p,this.args=m,this.state=p.__brush,this.active=0,this.clean=w}g.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(p,m){return this.starting?(this.starting=!1,this.emit("start",p,m)):this.emit("brush",p),this},brush:function(p,m){return this.emit("brush",p,m),this},end:function(p,m){return--this.active===0&&(delete this.state.emitter,this.emit("end",p,m)),this},emit:function(p,m,w){var v=ot(this.that).datum();o.call(p,this.that,new $l(p,{sourceEvent:m,target:l,selection:t.output(this.state.selection),mode:w,dispatch:o}),v)}};function f(p){if(s&&!p.touches||!e.apply(this,arguments))return;var m=this,w=p.target.__data__.type,v=(i&&p.metaKey?w="overlay":w)==="selection"?Fi:i&&p.altKey?on:rn,d=t===nr?null:zl[w],b=t===de?null:Ll[w],M=er(m),A=M.extent,T=M.selection,D=A[0][0],k,N,$=A[0][1],H,_,C=A[1][0],S,I,F=A[1][1],z,L,U=0,Y=0,K,O=d&&b&&i&&p.shiftKey,J,ct,q=Array.from(p.touches||[p],R=>{const et=R.identifier;return R=Ct(R,m),R.point0=R.slice(),R.identifier=et,R});dn(m);var ut=c(m,arguments,!0).beforestart();if(w==="overlay"){T&&(K=!0);const R=[q[0],q[1]||q[0]];M.selection=T=[[k=t===nr?D:ft(R[0][0],R[1][0]),H=t===de?$:ft(R[0][1],R[1][1])],[S=t===nr?C:lt(R[0][0],R[1][0]),z=t===de?F:lt(R[0][1],R[1][1])]],q.length>1&&nt(p)}else k=T[0][0],H=T[0][1],S=T[1][0],z=T[1][1];N=k,_=H,I=S,L=z;var P=ot(m).attr("pointer-events","none"),B=P.selectAll(".overlay").attr("cursor",Dt[w]);if(p.touches)ut.moved=E,ut.ended=V;else{var X=ot(p.view).on("mousemove.brush",E,!0).on("mouseup.brush",V,!0);i&&X.on("keydown.brush",ht,!0).on("keyup.brush",gt,!0),Jr(p.view)}u.call(m),ut.start(p,v.name);function E(R){for(const et of R.changedTouches||[R])for(const Cn of q)Cn.identifier===et.identifier&&(Cn.cur=Ct(et,m));if(O&&!J&&!ct&&q.length===1){const et=q[0];Hi(et.cur[0]-et[0])>Hi(et.cur[1]-et[1])?ct=!0:J=!0}for(const et of q)et.cur&&(et[0]=et.cur[0],et[1]=et.cur[1]);K=!0,je(R),nt(R)}function nt(R){const et=q[0],Cn=et.point0;var Bt;switch(U=et[0]-Cn[0],Y=et[1]-Cn[1],v){case tr:case Fi:{d&&(U=lt(D-k,ft(C-S,U)),N=k+U,I=S+U),b&&(Y=lt($-H,ft(F-z,Y)),_=H+Y,L=z+Y);break}case rn:{q[1]?(d&&(N=lt(D,ft(C,q[0][0])),I=lt(D,ft(C,q[1][0])),d=1),b&&(_=lt($,ft(F,q[0][1])),L=lt($,ft(F,q[1][1])),b=1)):(d<0?(U=lt(D-k,ft(C-k,U)),N=k+U,I=S):d>0&&(U=lt(D-S,ft(C-S,U)),N=k,I=S+U),b<0?(Y=lt($-H,ft(F-H,Y)),_=H+Y,L=z):b>0&&(Y=lt($-z,ft(F-z,Y)),_=H,L=z+Y));break}case on:{d&&(N=lt(D,ft(C,k-U*d)),I=lt(D,ft(C,S+U*d))),b&&(_=lt($,ft(F,H-Y*b)),L=lt($,ft(F,z+Y*b)));break}}I<N&&(d*=-1,Bt=k,k=S,S=Bt,Bt=N,N=I,I=Bt,w in Yi&&B.attr("cursor",Dt[w=Yi[w]])),L<_&&(b*=-1,Bt=H,H=z,z=Bt,Bt=_,_=L,L=Bt,w in Ri&&B.attr("cursor",Dt[w=Ri[w]])),M.selection&&(T=M.selection),J&&(N=T[0][0],I=T[1][0]),ct&&(_=T[0][1],L=T[1][1]),(T[0][0]!==N||T[0][1]!==_||T[1][0]!==I||T[1][1]!==L)&&(M.selection=[[N,_],[I,L]],u.call(m),ut.brush(R,v.name))}function V(R){if(Dl(R),R.touches){if(R.touches.length)return;s&&clearTimeout(s),s=setTimeout(function(){s=null},500)}else Qr(R.view,K),X.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);P.attr("pointer-events","all"),B.attr("cursor",Dt.overlay),M.selection&&(T=M.selection),Ul(T)&&(M.selection=null,u.call(m)),ut.end(R,v.name)}function ht(R){switch(R.keyCode){case 16:{O=d&&b;break}case 18:{v===rn&&(d&&(S=I-U*d,k=N+U*d),b&&(z=L-Y*b,H=_+Y*b),v=on,nt(R));break}case 32:{(v===rn||v===on)&&(d<0?S=I-U:d>0&&(k=N-U),b<0?z=L-Y:b>0&&(H=_-Y),v=tr,B.attr("cursor",Dt.selection),nt(R));break}default:return}je(R)}function gt(R){switch(R.keyCode){case 16:{O&&(J=ct=O=!1,nt(R));break}case 18:{v===on&&(d<0?S=I:d>0&&(k=N),b<0?z=L:b>0&&(H=_),v=rn,nt(R));break}case 32:{v===tr&&(R.altKey?(d&&(S=I-U*d,k=N+U*d),b&&(z=L-Y*b,H=_+Y*b),v=on):(d<0?S=I:d>0&&(k=N),b<0?z=L:b>0&&(H=_),v=rn),B.attr("cursor",Dt[w]),nt(R));break}default:return}je(R)}}function h(p){c(this,arguments).moved(p)}function y(p){c(this,arguments).ended(p)}function x(){var p=this.__brush||{selection:null};return p.extent=Ui(n.apply(this,arguments)),p.dim=t,p}return l.extent=function(p){return arguments.length?(n=typeof p=="function"?p:Qe(Ui(p)),l):n},l.filter=function(p){return arguments.length?(e=typeof p=="function"?p:Qe(!!p),l):e},l.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:Qe(!!p),l):r},l.handleSize=function(p){return arguments.length?(a=+p,l):a},l.keyModifiers=function(p){return arguments.length?(i=!!p,l):i},l.on=function(){var p=o.on.apply(o,arguments);return p===o?l:p},l}function Bl(t,n){var e,r=1;t==null&&(t=0),n==null&&(n=0);function i(){var o,a=e.length,s,l=0,u=0;for(o=0;o<a;++o)s=e[o],l+=s.x,u+=s.y;for(l=(l/a-t)*r,u=(u/a-n)*r,o=0;o<a;++o)s=e[o],s.x-=l,s.y-=u}return i.initialize=function(o){e=o},i.x=function(o){return arguments.length?(t=+o,i):t},i.y=function(o){return arguments.length?(n=+o,i):n},i.strength=function(o){return arguments.length?(r=+o,i):r},i}function Xl(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return oa(this.cover(n,e),n,e,t)}function oa(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o=t._root,a={data:r},s=t._x0,l=t._y0,u=t._x1,c=t._y1,g,f,h,y,x,p,m,w;if(!o)return t._root=a,t;for(;o.length;)if((x=n>=(g=(s+u)/2))?s=g:u=g,(p=e>=(f=(l+c)/2))?l=f:c=f,i=o,!(o=o[m=p<<1|x]))return i[m]=a,t;if(h=+t._x.call(null,o.data),y=+t._y.call(null,o.data),n===h&&e===y)return a.next=o,i?i[m]=a:t._root=a,t;do i=i?i[m]=new Array(4):t._root=new Array(4),(x=n>=(g=(s+u)/2))?s=g:u=g,(p=e>=(f=(l+c)/2))?l=f:c=f;while((m=p<<1|x)===(w=(y>=f)<<1|h>=g));return i[w]=o,i[m]=a,t}function Wl(t){var n,e,r=t.length,i,o,a=new Array(r),s=new Array(r),l=1/0,u=1/0,c=-1/0,g=-1/0;for(e=0;e<r;++e)isNaN(i=+this._x.call(null,n=t[e]))||isNaN(o=+this._y.call(null,n))||(a[e]=i,s[e]=o,i<l&&(l=i),i>c&&(c=i),o<u&&(u=o),o>g&&(g=o));if(l>c||u>g)return this;for(this.cover(l,u).cover(c,g),e=0;e<r;++e)oa(this,a[e],s[e],t[e]);return this}function Zl(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a=i-e||1,s=this._root,l,u;e>t||t>=i||r>n||n>=o;)switch(u=(n<r)<<1|t<e,l=new Array(4),l[u]=s,s=l,a*=2,u){case 0:i=e+a,o=r+a;break;case 1:e=i-a,o=r+a;break;case 2:i=e+a,r=o-a;break;case 3:e=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this}function Gl(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function Ol(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function dt(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function Vl(t,n,e){var r,i=this._x0,o=this._y0,a,s,l,u,c=this._x1,g=this._y1,f=[],h=this._root,y,x;for(h&&f.push(new dt(h,i,o,c,g)),e==null?e=1/0:(i=t-e,o=n-e,c=t+e,g=n+e,e*=e);y=f.pop();)if(!(!(h=y.node)||(a=y.x0)>c||(s=y.y0)>g||(l=y.x1)<i||(u=y.y1)<o))if(h.length){var p=(a+l)/2,m=(s+u)/2;f.push(new dt(h[3],p,m,l,u),new dt(h[2],a,m,p,u),new dt(h[1],p,s,l,m),new dt(h[0],a,s,p,m)),(x=(n>=m)<<1|t>=p)&&(y=f[f.length-1],f[f.length-1]=f[f.length-1-x],f[f.length-1-x]=y)}else{var w=t-+this._x.call(null,h.data),v=n-+this._y.call(null,h.data),d=w*w+v*v;if(d<e){var b=Math.sqrt(e=d);i=t-b,o=n-b,c=t+b,g=n+b,r=h.data}}return r}function ql(t){if(isNaN(c=+this._x.call(null,t))||isNaN(g=+this._y.call(null,t)))return this;var n,e=this._root,r,i,o,a=this._x0,s=this._y0,l=this._x1,u=this._y1,c,g,f,h,y,x,p,m;if(!e)return this;if(e.length)for(;;){if((y=c>=(f=(a+l)/2))?a=f:l=f,(x=g>=(h=(s+u)/2))?s=h:u=h,n=e,!(e=e[p=x<<1|y]))return this;if(!e.length)break;(n[p+1&3]||n[p+2&3]||n[p+3&3])&&(r=n,m=p)}for(;e.data!==t;)if(i=e,!(e=e.next))return this;return(o=e.next)&&delete e.next,i?(o?i.next=o:delete i.next,this):n?(o?n[p]=o:delete n[p],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[m]=e:this._root=e),this):(this._root=o,this)}function Kl(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function Jl(){return this._root}function Ql(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function jl(t){var n=[],e,r=this._root,i,o,a,s,l;for(r&&n.push(new dt(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,o=e.x0,a=e.y0,s=e.x1,l=e.y1)&&r.length){var u=(o+s)/2,c=(a+l)/2;(i=r[3])&&n.push(new dt(i,u,c,s,l)),(i=r[2])&&n.push(new dt(i,o,c,u,l)),(i=r[1])&&n.push(new dt(i,u,a,s,c)),(i=r[0])&&n.push(new dt(i,o,a,u,c))}return this}function tf(t){var n=[],e=[],r;for(this._root&&n.push(new dt(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,l=r.x1,u=r.y1,c=(a+l)/2,g=(s+u)/2;(o=i[0])&&n.push(new dt(o,a,s,c,g)),(o=i[1])&&n.push(new dt(o,c,s,l,g)),(o=i[2])&&n.push(new dt(o,a,g,c,u)),(o=i[3])&&n.push(new dt(o,c,g,l,u))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function nf(t){return t[0]}function ef(t){return arguments.length?(this._x=t,this):this._x}function rf(t){return t[1]}function of(t){return arguments.length?(this._y=t,this):this._y}function ii(t,n,e){var r=new oi(n??nf,e??rf,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function oi(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Bi(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var pt=ii.prototype=oi.prototype;pt.copy=function(){var t=new oi(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=Bi(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var i=0;i<4;++i)(r=n.source[i])&&(r.length?e.push({source:r,target:n.target[i]=new Array(4)}):n.target[i]=Bi(r));return t};pt.add=Xl;pt.addAll=Wl;pt.cover=Zl;pt.data=Gl;pt.extent=Ol;pt.find=Vl;pt.remove=ql;pt.removeAll=Kl;pt.root=Jl;pt.size=Ql;pt.visit=jl;pt.visitAfter=tf;pt.x=ef;pt.y=of;function Vt(t){return function(){return t}}function Xt(t){return(t()-.5)*1e-6}function af(t){return t.x+t.vx}function sf(t){return t.y+t.vy}function uf(t){var n,e,r,i=1,o=1;typeof t!="function"&&(t=Vt(t==null?1:+t));function a(){for(var u,c=n.length,g,f,h,y,x,p,m=0;m<o;++m)for(g=ii(n,af,sf).visitAfter(s),u=0;u<c;++u)f=n[u],x=e[f.index],p=x*x,h=f.x+f.vx,y=f.y+f.vy,g.visit(w);function w(v,d,b,M,A){var T=v.data,D=v.r,k=x+D;if(T){if(T.index>f.index){var N=h-T.x-T.vx,$=y-T.y-T.vy,H=N*N+$*$;H<k*k&&(N===0&&(N=Xt(r),H+=N*N),$===0&&($=Xt(r),H+=$*$),H=(k-(H=Math.sqrt(H)))/H*i,f.vx+=(N*=H)*(k=(D*=D)/(p+D)),f.vy+=($*=H)*k,T.vx-=N*(k=1-k),T.vy-=$*k)}return}return d>h+k||M<h-k||b>y+k||A<y-k}}function s(u){if(u.data)return u.r=e[u.data.index];for(var c=u.r=0;c<4;++c)u[c]&&u[c].r>u.r&&(u.r=u[c].r)}function l(){if(n){var u,c=n.length,g;for(e=new Array(c),u=0;u<c;++u)g=n[u],e[g.index]=+t(g,u,n)}}return a.initialize=function(u,c){n=u,r=c,l()},a.iterations=function(u){return arguments.length?(o=+u,a):o},a.strength=function(u){return arguments.length?(i=+u,a):i},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Vt(+u),l(),a):t},a}function cf(t){return t.index}function Xi(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function lf(t){var n=cf,e=g,r,i=Vt(30),o,a,s,l,u,c=1;t==null&&(t=[]);function g(p){return 1/Math.min(s[p.source.index],s[p.target.index])}function f(p){for(var m=0,w=t.length;m<c;++m)for(var v=0,d,b,M,A,T,D,k;v<w;++v)d=t[v],b=d.source,M=d.target,A=M.x+M.vx-b.x-b.vx||Xt(u),T=M.y+M.vy-b.y-b.vy||Xt(u),D=Math.sqrt(A*A+T*T),D=(D-o[v])/D*p*r[v],A*=D,T*=D,M.vx-=A*(k=l[v]),M.vy-=T*k,b.vx+=A*(k=1-k),b.vy+=T*k}function h(){if(a){var p,m=a.length,w=t.length,v=new Map(a.map((b,M)=>[n(b,M,a),b])),d;for(p=0,s=new Array(m);p<w;++p)d=t[p],d.index=p,typeof d.source!="object"&&(d.source=Xi(v,d.source)),typeof d.target!="object"&&(d.target=Xi(v,d.target)),s[d.source.index]=(s[d.source.index]||0)+1,s[d.target.index]=(s[d.target.index]||0)+1;for(p=0,l=new Array(w);p<w;++p)d=t[p],l[p]=s[d.source.index]/(s[d.source.index]+s[d.target.index]);r=new Array(w),y(),o=new Array(w),x()}}function y(){if(a)for(var p=0,m=t.length;p<m;++p)r[p]=+e(t[p],p,t)}function x(){if(a)for(var p=0,m=t.length;p<m;++p)o[p]=+i(t[p],p,t)}return f.initialize=function(p,m){a=p,u=m,h()},f.links=function(p){return arguments.length?(t=p,h(),f):t},f.id=function(p){return arguments.length?(n=p,f):n},f.iterations=function(p){return arguments.length?(c=+p,f):c},f.strength=function(p){return arguments.length?(e=typeof p=="function"?p:Vt(+p),y(),f):e},f.distance=function(p){return arguments.length?(i=typeof p=="function"?p:Vt(+p),x(),f):i},f}const ff=1664525,hf=1013904223,Wi=4294967296;function gf(){let t=1;return()=>(t=(ff*t+hf)%Wi)/Wi}function df(t){return t.x}function pf(t){return t.y}var mf=10,yf=Math.PI*(3-Math.sqrt(5));function vf(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,l=We(g),u=bn("tick","end"),c=gf();t==null&&(t=[]);function g(){f(),u.call("tick",n),e<r&&(l.stop(),u.call("end",n))}function f(x){var p,m=t.length,w;x===void 0&&(x=1);for(var v=0;v<x;++v)for(e+=(o-e)*i,s.forEach(function(d){d(e)}),p=0;p<m;++p)w=t[p],w.fx==null?w.x+=w.vx*=a:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=a:(w.y=w.fy,w.vy=0);return n}function h(){for(var x=0,p=t.length,m;x<p;++x){if(m=t[x],m.index=x,m.fx!=null&&(m.x=m.fx),m.fy!=null&&(m.y=m.fy),isNaN(m.x)||isNaN(m.y)){var w=mf*Math.sqrt(.5+x),v=x*yf;m.x=w*Math.cos(v),m.y=w*Math.sin(v)}(isNaN(m.vx)||isNaN(m.vy))&&(m.vx=m.vy=0)}}function y(x){return x.initialize&&x.initialize(t,c),x}return h(),n={tick:f,restart:function(){return l.restart(g),n},stop:function(){return l.stop(),n},nodes:function(x){return arguments.length?(t=x,h(),s.forEach(y),n):t},alpha:function(x){return arguments.length?(e=+x,n):e},alphaMin:function(x){return arguments.length?(r=+x,n):r},alphaDecay:function(x){return arguments.length?(i=+x,n):+i},alphaTarget:function(x){return arguments.length?(o=+x,n):o},velocityDecay:function(x){return arguments.length?(a=1-x,n):1-a},randomSource:function(x){return arguments.length?(c=x,s.forEach(y),n):c},force:function(x,p){return arguments.length>1?(p==null?s.delete(x):s.set(x,y(p)),n):s.get(x)},find:function(x,p,m){var w=0,v=t.length,d,b,M,A,T;for(m==null?m=1/0:m*=m,w=0;w<v;++w)A=t[w],d=x-A.x,b=p-A.y,M=d*d+b*b,M<m&&(T=A,m=M);return T},on:function(x,p){return arguments.length>1?(u.on(x,p),n):u.on(x)}}}function wf(){var t,n,e,r,i=Vt(-30),o,a=1,s=1/0,l=.81;function u(h){var y,x=t.length,p=ii(t,df,pf).visitAfter(g);for(r=h,y=0;y<x;++y)n=t[y],p.visit(f)}function c(){if(t){var h,y=t.length,x;for(o=new Array(y),h=0;h<y;++h)x=t[h],o[x.index]=+i(x,h,t)}}function g(h){var y=0,x,p,m=0,w,v,d;if(h.length){for(w=v=d=0;d<4;++d)(x=h[d])&&(p=Math.abs(x.value))&&(y+=x.value,m+=p,w+=p*x.x,v+=p*x.y);h.x=w/m,h.y=v/m}else{x=h,x.x=x.data.x,x.y=x.data.y;do y+=o[x.data.index];while(x=x.next)}h.value=y}function f(h,y,x,p){if(!h.value)return!0;var m=h.x-n.x,w=h.y-n.y,v=p-y,d=m*m+w*w;if(v*v/l<d)return d<s&&(m===0&&(m=Xt(e),d+=m*m),w===0&&(w=Xt(e),d+=w*w),d<a&&(d=Math.sqrt(a*d)),n.vx+=m*h.value*r/d,n.vy+=w*h.value*r/d),!0;if(h.length||d>=s)return;(h.data!==n||h.next)&&(m===0&&(m=Xt(e),d+=m*m),w===0&&(w=Xt(e),d+=w*w),d<a&&(d=Math.sqrt(a*d)));do h.data!==n&&(v=o[h.data.index]*r/d,n.vx+=m*v,n.vy+=w*v);while(h=h.next)}return u.initialize=function(h,y){t=h,e=y,c()},u.strength=function(h){return arguments.length?(i=typeof h=="function"?h:Vt(+h),c(),u):i},u.distanceMin=function(h){return arguments.length?(a=h*h,u):Math.sqrt(a)},u.distanceMax=function(h){return arguments.length?(s=h*h,u):Math.sqrt(s)},u.theta=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u}function xf(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Ce(t,n){if(!isFinite(t)||t===0)return null;var e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"),r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function yn(t){return t=Ce(Math.abs(t)),t?t[1]:NaN}function _f(t,n){return function(e,r){for(var i=e.length,o=[],a=0,s=t[0],l=0;i>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),o.push(e.substring(i-=s,i+s)),!((l+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(n)}}function Mf(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var bf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Se(t){if(!(n=bf.exec(t)))throw new Error("invalid format: "+t);var n;return new ai({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Se.prototype=ai.prototype;function ai(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ai.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Cf(t){t:for(var n=t.length,e=1,r=-1,i;e<n;++e)switch(t[e]){case".":r=i=e;break;case"0":r===0&&(r=e),i=e;break;default:if(!+t[e])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ae;function Sf(t,n){var e=Ce(t,n);if(!e)return Ae=void 0,t.toPrecision(n);var r=e[0],i=e[1],o=i-(Ae=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Ce(t,Math.max(0,n+o-1))[0]}function Zi(t,n){var e=Ce(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Gi={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:xf,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>Zi(t*100,n),r:Zi,s:Sf,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Oi(t){return t}var Vi=Array.prototype.map,qi=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Af(t){var n=t.grouping===void 0||t.thousands===void 0?Oi:_f(Vi.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Oi:Mf(Vi.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(g,f){g=Se(g);var h=g.fill,y=g.align,x=g.sign,p=g.symbol,m=g.zero,w=g.width,v=g.comma,d=g.precision,b=g.trim,M=g.type;M==="n"?(v=!0,M="g"):Gi[M]||(d===void 0&&(d=12),b=!0,M="g"),(m||h==="0"&&y==="=")&&(m=!0,h="0",y="=");var A=((f==null?void 0:f.prefix)!==void 0?f.prefix:"")+(p==="$"?e:p==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():""),T=(p==="$"?r:/[%p]/.test(M)?a:"")+((f==null?void 0:f.suffix)!==void 0?f.suffix:""),D=Gi[M],k=/[defgprs%]/.test(M);d=d===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d));function N($){var H=A,_=T,C,S,I;if(M==="c")_=D($)+_,$="";else{$=+$;var F=$<0||1/$<0;if($=isNaN($)?l:D(Math.abs($),d),b&&($=Cf($)),F&&+$==0&&x!=="+"&&(F=!1),H=(F?x==="("?x:s:x==="-"||x==="("?"":x)+H,_=(M==="s"&&!isNaN($)&&Ae!==void 0?qi[8+Ae/3]:"")+_+(F&&x==="("?")":""),k){for(C=-1,S=$.length;++C<S;)if(I=$.charCodeAt(C),48>I||I>57){_=(I===46?i+$.slice(C+1):$.slice(C))+_,$=$.slice(0,C);break}}}v&&!m&&($=n($,1/0));var z=H.length+$.length+_.length,L=z<w?new Array(w-z+1).join(h):"";switch(v&&m&&($=n(L+$,L.length?w-_.length:1/0),L=""),y){case"<":$=H+$+_+L;break;case"=":$=H+L+$+_;break;case"^":$=L.slice(0,z=L.length>>1)+H+$+_+L.slice(z);break;default:$=L+H+$+_;break}return o($)}return N.toString=function(){return g+""},N}function c(g,f){var h=Math.max(-8,Math.min(8,Math.floor(yn(f)/3)))*3,y=Math.pow(10,-h),x=u((g=Se(g),g.type="f",g),{suffix:qi[8+h/3]});return function(p){return x(y*p)}}return{format:u,formatPrefix:c}}var ne,si,aa;Tf({thousands:",",grouping:[3],currency:["$",""]});function Tf(t){return ne=Af(t),si=ne.format,aa=ne.formatPrefix,ne}function If(t){return Math.max(0,-yn(Math.abs(t)))}function Nf(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(yn(n)/3)))*3-yn(Math.abs(t)))}function Ef(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,yn(n)-yn(t))+1}var W=1e-6,Z=Math.PI,xt=Z/2,Ki=Z/4,bt=Z*2,zt=180/Z,yt=Z/180,Q=Math.abs,kf=Math.atan,vn=Math.atan2,tt=Math.cos,ee=Math.ceil,j=Math.sin,$f=Math.sign||function(t){return t>0?1:t<0?-1:0},Zt=Math.sqrt;function Df(t){return t>1?0:t<-1?Z:Math.acos(t)}function Qt(t){return t>1?xt:t<-1?-xt:Math.asin(t)}function _t(){}function Te(t,n){t&&Qi.hasOwnProperty(t.type)&&Qi[t.type](t,n)}var Ji={Feature:function(t,n){Te(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Te(e[r].geometry,n)}},Qi={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){Nr(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)Nr(e[r],n,0)},Polygon:function(t,n){ji(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)ji(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Te(e[r],n)}};function Nr(t,n,e){var r=-1,i=t.length-e,o;for(n.lineStart();++r<i;)o=t[r],n.point(o[0],o[1],o[2]);n.lineEnd()}function ji(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)Nr(t[e],n,1);n.polygonEnd()}function sn(t,n){t&&Ji.hasOwnProperty(t.type)?Ji[t.type](t,n):Te(t,n)}function Er(t){return[vn(t[1],t[0]),Qt(t[2])]}function wn(t){var n=t[0],e=t[1],r=tt(e);return[r*tt(n),r*j(n),j(e)]}function re(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Ie(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function rr(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function ie(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function kr(t){var n=Zt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function $r(t,n){function e(r,i){return r=t(r,i),n(r[0],r[1])}return t.invert&&n.invert&&(e.invert=function(r,i){return r=n.invert(r,i),r&&t.invert(r[0],r[1])}),e}function Dr(t,n){return Q(t)>Z&&(t-=Math.round(t/bt)*bt),[t,n]}Dr.invert=Dr;function zf(t,n,e){return(t%=bt)?n||e?$r(no(t),eo(n,e)):no(t):n||e?eo(n,e):Dr}function to(t){return function(n,e){return n+=t,Q(n)>Z&&(n-=Math.round(n/bt)*bt),[n,e]}}function no(t){var n=to(t);return n.invert=to(-t),n}function eo(t,n){var e=tt(t),r=j(t),i=tt(n),o=j(n);function a(s,l){var u=tt(l),c=tt(s)*u,g=j(s)*u,f=j(l),h=f*e+c*r;return[vn(g*i-h*o,c*e-f*r),Qt(h*i+g*o)]}return a.invert=function(s,l){var u=tt(l),c=tt(s)*u,g=j(s)*u,f=j(l),h=f*i-g*o;return[vn(g*i+f*o,c*e+h*r),Qt(h*e-c*r)]},a}function Lf(t,n,e,r,i,o){if(e){var a=tt(n),s=j(n),l=r*e;i==null?(i=n+r*bt,o=n-l/2):(i=ro(a,i),o=ro(a,o),(r>0?i<o:i>o)&&(i+=r*bt));for(var u,c=i;r>0?c>o:c<o;c-=l)u=Er([a,-s*tt(c),-s*j(c)]),t.point(u[0],u[1])}}function ro(t,n){n=wn(n),n[0]-=t,kr(n);var e=Df(-n[1]);return((-n[2]<0?-e:e)+bt-W)%bt}function sa(){var t=[],n;return{point:function(e,r,i){n.push([e,r,i])},lineStart:function(){t.push(n=[])},lineEnd:_t,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],n=null,e}}}function pe(t,n){return Q(t[0]-n[0])<W&&Q(t[1]-n[1])<W}function oe(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function ua(t,n,e,r,i){var o=[],a=[],s,l;if(t.forEach(function(y){if(!((x=y.length-1)<=0)){var x,p=y[0],m=y[x],w;if(pe(p,m)){if(!p[2]&&!m[2]){for(i.lineStart(),s=0;s<x;++s)i.point((p=y[s])[0],p[1]);i.lineEnd();return}m[0]+=2*W}o.push(w=new oe(p,y,null,!0)),a.push(w.o=new oe(p,null,w,!1)),o.push(w=new oe(m,y,null,!1)),a.push(w.o=new oe(m,null,w,!0))}}),!!o.length){for(a.sort(n),io(o),io(a),s=0,l=a.length;s<l;++s)a[s].e=e=!e;for(var u=o[0],c,g;;){for(var f=u,h=!0;f.v;)if((f=f.n)===u)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(h)for(s=0,l=c.length;s<l;++s)i.point((g=c[s])[0],g[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(h)for(c=f.p.z,s=c.length-1;s>=0;--s)i.point((g=c[s])[0],g[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,h=!h}while(!f.v);i.lineEnd()}}}function io(t){if(n=t.length){for(var n,e=0,r=t[0],i;++e<n;)r.n=i=t[e],i.p=r,r=i;r.n=i=t[0],i.p=r}}function ir(t){return Q(t[0])<=Z?t[0]:$f(t[0])*((Q(t[0])+Z)%bt-Z)}function Ff(t,n){var e=ir(n),r=n[1],i=j(r),o=[j(e),-tt(e),0],a=0,s=0,l=new qt;i===1?r=xt+W:i===-1&&(r=-xt-W);for(var u=0,c=t.length;u<c;++u)if(f=(g=t[u]).length)for(var g,f,h=g[f-1],y=ir(h),x=h[1]/2+Ki,p=j(x),m=tt(x),w=0;w<f;++w,y=d,p=M,m=A,h=v){var v=g[w],d=ir(v),b=v[1]/2+Ki,M=j(b),A=tt(b),T=d-y,D=T>=0?1:-1,k=D*T,N=k>Z,$=p*M;if(l.add(vn($*D*j(k),m*A+$*tt(k))),a+=N?T+D*bt:T,N^y>=e^d>=e){var H=Ie(wn(h),wn(v));kr(H);var _=Ie(o,H);kr(_);var C=(N^T>=0?-1:1)*Qt(_[2]);(r>C||r===C&&(H[0]||H[1]))&&(s+=N^T>=0?1:-1)}}return(a<-W||a<W&&l<-1e-12)^s&1}function ca(t,n,e,r){return function(i){var o=n(i),a=sa(),s=n(a),l=!1,u,c,g,f={point:h,lineStart:x,lineEnd:p,polygonStart:function(){f.point=m,f.lineStart=w,f.lineEnd=v,c=[],u=[]},polygonEnd:function(){f.point=h,f.lineStart=x,f.lineEnd=p,c=Do(c);var d=Ff(u,r);c.length?(l||(i.polygonStart(),l=!0),ua(c,Pf,d,e,i)):d&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),c=u=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(d,b){t(d,b)&&i.point(d,b)}function y(d,b){o.point(d,b)}function x(){f.point=y,o.lineStart()}function p(){f.point=h,o.lineEnd()}function m(d,b){g.push([d,b]),s.point(d,b)}function w(){s.lineStart(),g=[]}function v(){m(g[0][0],g[0][1]),s.lineEnd();var d=s.clean(),b=a.result(),M,A=b.length,T,D,k;if(g.pop(),u.push(g),g=null,!!A){if(d&1){if(D=b[0],(T=D.length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),M=0;M<T;++M)i.point((k=D[M])[0],k[1]);i.lineEnd()}return}A>1&&d&2&&b.push(b.pop().concat(b.shift())),c.push(b.filter(Hf))}}return f}}function Hf(t){return t.length>1}function Pf(t,n){return((t=t.x)[0]<0?t[1]-xt-W:xt-t[1])-((n=n.x)[0]<0?n[1]-xt-W:xt-n[1])}const oo=ca(function(){return!0},Uf,Rf,[-Z,-xt]);function Uf(t){var n=NaN,e=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(o,a){var s=o>0?Z:-Z,l=Q(o-n);Q(l-Z)<W?(t.point(n,e=(e+a)/2>0?xt:-xt),t.point(r,e),t.lineEnd(),t.lineStart(),t.point(s,e),t.point(o,e),i=0):r!==s&&l>=Z&&(Q(n-r)<W&&(n-=r*W),Q(o-s)<W&&(o-=s*W),e=Yf(n,e,o,a),t.point(r,e),t.lineEnd(),t.lineStart(),t.point(s,e),i=0),t.point(n=o,e=a),r=s},lineEnd:function(){t.lineEnd(),n=e=NaN},clean:function(){return 2-i}}}function Yf(t,n,e,r){var i,o,a=j(t-e);return Q(a)>W?kf((j(n)*(o=tt(r))*j(e)-j(r)*(i=tt(n))*j(t))/(i*o*a)):(n+r)/2}function Rf(t,n,e,r){var i;if(t==null)i=e*xt,r.point(-Z,i),r.point(0,i),r.point(Z,i),r.point(Z,0),r.point(Z,-i),r.point(0,-i),r.point(-Z,-i),r.point(-Z,0),r.point(-Z,i);else if(Q(t[0]-n[0])>W){var o=t[0]<n[0]?Z:-Z;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])}function Bf(t){var n=tt(t),e=2*yt,r=n>0,i=Q(n)>W;function o(c,g,f,h){Lf(h,t,e,f,c,g)}function a(c,g){return tt(c)*tt(g)>n}function s(c){var g,f,h,y,x;return{lineStart:function(){y=h=!1,x=1},point:function(p,m){var w=[p,m],v,d=a(p,m),b=r?d?0:u(p,m):d?u(p+(p<0?Z:-Z),m):0;if(!g&&(y=h=d)&&c.lineStart(),d!==h&&(v=l(g,w),(!v||pe(g,v)||pe(w,v))&&(w[2]=1)),d!==h)x=0,d?(c.lineStart(),v=l(w,g),c.point(v[0],v[1])):(v=l(g,w),c.point(v[0],v[1],2),c.lineEnd()),g=v;else if(i&&g&&r^d){var M;!(b&f)&&(M=l(w,g,!0))&&(x=0,r?(c.lineStart(),c.point(M[0][0],M[0][1]),c.point(M[1][0],M[1][1]),c.lineEnd()):(c.point(M[1][0],M[1][1]),c.lineEnd(),c.lineStart(),c.point(M[0][0],M[0][1],3)))}d&&(!g||!pe(g,w))&&c.point(w[0],w[1]),g=w,h=d,f=b},lineEnd:function(){h&&c.lineEnd(),g=null},clean:function(){return x|(y&&h)<<1}}}function l(c,g,f){var h=wn(c),y=wn(g),x=[1,0,0],p=Ie(h,y),m=re(p,p),w=p[0],v=m-w*w;if(!v)return!f&&c;var d=n*m/v,b=-n*w/v,M=Ie(x,p),A=ie(x,d),T=ie(p,b);rr(A,T);var D=M,k=re(A,D),N=re(D,D),$=k*k-N*(re(A,A)-1);if(!($<0)){var H=Zt($),_=ie(D,(-k-H)/N);if(rr(_,A),_=Er(_),!f)return _;var C=c[0],S=g[0],I=c[1],F=g[1],z;S<C&&(z=C,C=S,S=z);var L=S-C,U=Q(L-Z)<W,Y=U||L<W;if(!U&&F<I&&(z=I,I=F,F=z),Y?U?I+F>0^_[1]<(Q(_[0]-C)<W?I:F):I<=_[1]&&_[1]<=F:L>Z^(C<=_[0]&&_[0]<=S)){var K=ie(D,(-k+H)/N);return rr(K,A),[_,Er(K)]}}}function u(c,g){var f=r?t:Z-t,h=0;return c<-f?h|=1:c>f&&(h|=2),g<-f?h|=4:g>f&&(h|=8),h}return ca(a,s,o,r?[0,-t]:[-Z,t-Z])}function Xf(t,n,e,r,i,o){var a=t[0],s=t[1],l=n[0],u=n[1],c=0,g=1,f=l-a,h=u-s,y;if(y=e-a,!(!f&&y>0)){if(y/=f,f<0){if(y<c)return;y<g&&(g=y)}else if(f>0){if(y>g)return;y>c&&(c=y)}if(y=i-a,!(!f&&y<0)){if(y/=f,f<0){if(y>g)return;y>c&&(c=y)}else if(f>0){if(y<c)return;y<g&&(g=y)}if(y=r-s,!(!h&&y>0)){if(y/=h,h<0){if(y<c)return;y<g&&(g=y)}else if(h>0){if(y>g)return;y>c&&(c=y)}if(y=o-s,!(!h&&y<0)){if(y/=h,h<0){if(y>g)return;y>c&&(c=y)}else if(h>0){if(y<c)return;y<g&&(g=y)}return c>0&&(t[0]=a+c*f,t[1]=s+c*h),g<1&&(n[0]=a+g*f,n[1]=s+g*h),!0}}}}}var Dn=1e9,ae=-Dn;function Wf(t,n,e,r){function i(u,c){return t<=u&&u<=e&&n<=c&&c<=r}function o(u,c,g,f){var h=0,y=0;if(u==null||(h=a(u,g))!==(y=a(c,g))||l(u,c)<0^g>0)do f.point(h===0||h===3?t:e,h>1?r:n);while((h=(h+g+4)%4)!==y);else f.point(c[0],c[1])}function a(u,c){return Q(u[0]-t)<W?c>0?0:3:Q(u[0]-e)<W?c>0?2:1:Q(u[1]-n)<W?c>0?1:0:c>0?3:2}function s(u,c){return l(u.x,c.x)}function l(u,c){var g=a(u,1),f=a(c,1);return g!==f?g-f:g===0?c[1]-u[1]:g===1?u[0]-c[0]:g===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,g=sa(),f,h,y,x,p,m,w,v,d,b,M,A={point:T,lineStart:$,lineEnd:H,polygonStart:k,polygonEnd:N};function T(C,S){i(C,S)&&c.point(C,S)}function D(){for(var C=0,S=0,I=h.length;S<I;++S)for(var F=h[S],z=1,L=F.length,U=F[0],Y,K,O=U[0],J=U[1];z<L;++z)Y=O,K=J,U=F[z],O=U[0],J=U[1],K<=r?J>r&&(O-Y)*(r-K)>(J-K)*(t-Y)&&++C:J<=r&&(O-Y)*(r-K)<(J-K)*(t-Y)&&--C;return C}function k(){c=g,f=[],h=[],M=!0}function N(){var C=D(),S=M&&C,I=(f=Do(f)).length;(S||I)&&(u.polygonStart(),S&&(u.lineStart(),o(null,null,1,u),u.lineEnd()),I&&ua(f,s,C,o,u),u.polygonEnd()),c=u,f=h=y=null}function $(){A.point=_,h&&h.push(y=[]),b=!0,d=!1,w=v=NaN}function H(){f&&(_(x,p),m&&d&&g.rejoin(),f.push(g.result())),A.point=T,d&&c.lineEnd()}function _(C,S){var I=i(C,S);if(h&&y.push([C,S]),b)x=C,p=S,m=I,b=!1,I&&(c.lineStart(),c.point(C,S));else if(I&&d)c.point(C,S);else{var F=[w=Math.max(ae,Math.min(Dn,w)),v=Math.max(ae,Math.min(Dn,v))],z=[C=Math.max(ae,Math.min(Dn,C)),S=Math.max(ae,Math.min(Dn,S))];Xf(F,z,t,n,e,r)?(d||(c.lineStart(),c.point(F[0],F[1])),c.point(z[0],z[1]),I||c.lineEnd(),M=!1):I&&(c.lineStart(),c.point(C,S),M=!1)}w=C,v=S,d=I}return A}}function ao(t,n,e){var r=un(t,n-W,e).concat(n);return function(i){return r.map(function(o){return[i,o]})}}function so(t,n,e){var r=un(t,n-W,e).concat(n);return function(i){return r.map(function(o){return[o,i]})}}function Zf(){var t,n,e,r,i,o,a,s,l=10,u=l,c=90,g=360,f,h,y,x,p=2.5;function m(){return{type:"MultiLineString",coordinates:w()}}function w(){return un(ee(r/c)*c,e,c).map(y).concat(un(ee(s/g)*g,a,g).map(x)).concat(un(ee(n/l)*l,t,l).filter(function(v){return Q(v%c)>W}).map(f)).concat(un(ee(o/u)*u,i,u).filter(function(v){return Q(v%g)>W}).map(h))}return m.lines=function(){return w().map(function(v){return{type:"LineString",coordinates:v}})},m.outline=function(){return{type:"Polygon",coordinates:[y(r).concat(x(a).slice(1),y(e).reverse().slice(1),x(s).reverse().slice(1))]}},m.extent=function(v){return arguments.length?m.extentMajor(v).extentMinor(v):m.extentMinor()},m.extentMajor=function(v){return arguments.length?(r=+v[0][0],e=+v[1][0],s=+v[0][1],a=+v[1][1],r>e&&(v=r,r=e,e=v),s>a&&(v=s,s=a,a=v),m.precision(p)):[[r,s],[e,a]]},m.extentMinor=function(v){return arguments.length?(n=+v[0][0],t=+v[1][0],o=+v[0][1],i=+v[1][1],n>t&&(v=n,n=t,t=v),o>i&&(v=o,o=i,i=v),m.precision(p)):[[n,o],[t,i]]},m.step=function(v){return arguments.length?m.stepMajor(v).stepMinor(v):m.stepMinor()},m.stepMajor=function(v){return arguments.length?(c=+v[0],g=+v[1],m):[c,g]},m.stepMinor=function(v){return arguments.length?(l=+v[0],u=+v[1],m):[l,u]},m.precision=function(v){return arguments.length?(p=+v,f=ao(o,i,90),h=so(n,t,p),y=ao(s,a,90),x=so(r,e,p),m):p},m.extentMajor([[-180,-90+W],[180,90-W]]).extentMinor([[-180,-80-W],[180,80+W]])}const zr=t=>t;var or=new qt,Lr=new qt,la,fa,Fr,Hr,Lt={point:_t,lineStart:_t,lineEnd:_t,polygonStart:function(){Lt.lineStart=Gf,Lt.lineEnd=Vf},polygonEnd:function(){Lt.lineStart=Lt.lineEnd=Lt.point=_t,or.add(Q(Lr)),Lr=new qt},result:function(){var t=or/2;return or=new qt,t}};function Gf(){Lt.point=Of}function Of(t,n){Lt.point=ha,la=Fr=t,fa=Hr=n}function ha(t,n){Lr.add(Hr*t-Fr*n),Fr=t,Hr=n}function Vf(){ha(la,fa)}var xn=1/0,Ne=xn,Wn=-xn,Ee=Wn,ke={point:qf,lineStart:_t,lineEnd:_t,polygonStart:_t,polygonEnd:_t,result:function(){var t=[[xn,Ne],[Wn,Ee]];return Wn=Ee=-(Ne=xn=1/0),t}};function qf(t,n){t<xn&&(xn=t),t>Wn&&(Wn=t),n<Ne&&(Ne=n),n>Ee&&(Ee=n)}var Pr=0,Ur=0,zn=0,$e=0,De=0,cn=0,Yr=0,Rr=0,Ln=0,ga,da,It,Nt,wt={point:jt,lineStart:uo,lineEnd:co,polygonStart:function(){wt.lineStart=Qf,wt.lineEnd=jf},polygonEnd:function(){wt.point=jt,wt.lineStart=uo,wt.lineEnd=co},result:function(){var t=Ln?[Yr/Ln,Rr/Ln]:cn?[$e/cn,De/cn]:zn?[Pr/zn,Ur/zn]:[NaN,NaN];return Pr=Ur=zn=$e=De=cn=Yr=Rr=Ln=0,t}};function jt(t,n){Pr+=t,Ur+=n,++zn}function uo(){wt.point=Kf}function Kf(t,n){wt.point=Jf,jt(It=t,Nt=n)}function Jf(t,n){var e=t-It,r=n-Nt,i=Zt(e*e+r*r);$e+=i*(It+t)/2,De+=i*(Nt+n)/2,cn+=i,jt(It=t,Nt=n)}function co(){wt.point=jt}function Qf(){wt.point=th}function jf(){pa(ga,da)}function th(t,n){wt.point=pa,jt(ga=It=t,da=Nt=n)}function pa(t,n){var e=t-It,r=n-Nt,i=Zt(e*e+r*r);$e+=i*(It+t)/2,De+=i*(Nt+n)/2,cn+=i,i=Nt*t-It*n,Yr+=i*(It+t),Rr+=i*(Nt+n),Ln+=i*3,jt(It=t,Nt=n)}function ma(t){this._context=t}ma.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:{this._context.moveTo(t,n),this._point=1;break}case 1:{this._context.lineTo(t,n);break}default:{this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,bt);break}}},result:_t};var Br=new qt,ar,ya,va,Fn,Hn,Zn={point:_t,lineStart:function(){Zn.point=nh},lineEnd:function(){ar&&wa(ya,va),Zn.point=_t},polygonStart:function(){ar=!0},polygonEnd:function(){ar=null},result:function(){var t=+Br;return Br=new qt,t}};function nh(t,n){Zn.point=wa,ya=Fn=t,va=Hn=n}function wa(t,n){Fn-=t,Hn-=n,Br.add(Zt(Fn*Fn+Hn*Hn)),Fn=t,Hn=n}let lo,ze,fo,ho;class go{constructor(n){this._append=n==null?xa:eh(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(n,e){switch(this._point){case 0:{this._append`M${n},${e}`,this._point=1;break}case 1:{this._append`L${n},${e}`;break}default:{if(this._append`M${n},${e}`,this._radius!==fo||this._append!==ze){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,fo=r,ze=this._append,ho=this._,this._=i}this._+=ho;break}}}result(){const n=this._;return this._="",n.length?n:null}}function xa(t){let n=1;this._+=t[0];for(const e=t.length;n<e;++n)this._+=arguments[n]+t[n]}function eh(t){const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);if(n>15)return xa;if(n!==lo){const e=10**n;lo=n,ze=function(i){let o=1;this._+=i[0];for(const a=i.length;o<a;++o)this._+=Math.round(arguments[o]*e)/e+i[o]}}return ze}function rh(t,n){let e=3,r=4.5,i,o;function a(s){return s&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),sn(s,i(o))),o.result()}return a.area=function(s){return sn(s,i(Lt)),Lt.result()},a.measure=function(s){return sn(s,i(Zn)),Zn.result()},a.bounds=function(s){return sn(s,i(ke)),ke.result()},a.centroid=function(s){return sn(s,i(wt)),wt.result()},a.projection=function(s){return arguments.length?(i=s==null?(t=null,zr):(t=s).stream,a):t},a.context=function(s){return arguments.length?(o=s==null?(n=null,new go(e)):new ma(n=s),typeof r!="function"&&o.pointRadius(r),a):n},a.pointRadius=function(s){return arguments.length?(r=typeof s=="function"?s:(o.pointRadius(+s),+s),a):r},a.digits=function(s){if(!arguments.length)return e;if(s==null)e=null;else{const l=Math.floor(s);if(!(l>=0))throw new RangeError(`invalid digits: ${s}`);e=l}return n===null&&(o=new go(e)),a},a.projection(t).digits(e).context(n)}function ui(t){return function(n){var e=new Xr;for(var r in t)e[r]=t[r];return e.stream=n,e}}function Xr(){}Xr.prototype={constructor:Xr,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ci(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),sn(e,t.stream(ke)),n(ke.result()),r!=null&&t.clipExtent(r),t}function _a(t,n,e){return ci(t,function(r){var i=n[1][0]-n[0][0],o=n[1][1]-n[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+n[0][0]+(i-a*(r[1][0]+r[0][0]))/2,l=+n[0][1]+(o-a*(r[1][1]+r[0][1]))/2;t.scale(150*a).translate([s,l])},e)}function ih(t,n,e){return _a(t,[[0,0],n],e)}function oh(t,n,e){return ci(t,function(r){var i=+n,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];t.scale(150*o).translate([a,s])},e)}function ah(t,n,e){return ci(t,function(r){var i=+n,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([a,s])},e)}var po=16,sh=tt(30*yt);function mo(t,n){return+n?ch(t,n):uh(t)}function uh(t){return ui({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}function ch(t,n){function e(r,i,o,a,s,l,u,c,g,f,h,y,x,p){var m=u-r,w=c-i,v=m*m+w*w;if(v>4*n&&x--){var d=a+f,b=s+h,M=l+y,A=Zt(d*d+b*b+M*M),T=Qt(M/=A),D=Q(Q(M)-1)<W||Q(o-g)<W?(o+g)/2:vn(b,d),k=t(D,T),N=k[0],$=k[1],H=N-r,_=$-i,C=w*H-m*_;(C*C/v>n||Q((m*H+w*_)/v-.5)>.3||a*f+s*h+l*y<sh)&&(e(r,i,o,a,s,l,N,$,D,d/=A,b/=A,M,x,p),p.point(N,$),e(N,$,D,d,b,M,u,c,g,f,h,y,x,p))}}return function(r){var i,o,a,s,l,u,c,g,f,h,y,x,p={point:m,lineStart:w,lineEnd:d,polygonStart:function(){r.polygonStart(),p.lineStart=b},polygonEnd:function(){r.polygonEnd(),p.lineStart=w}};function m(T,D){T=t(T,D),r.point(T[0],T[1])}function w(){g=NaN,p.point=v,r.lineStart()}function v(T,D){var k=wn([T,D]),N=t(T,D);e(g,f,c,h,y,x,g=N[0],f=N[1],c=T,h=k[0],y=k[1],x=k[2],po,r),r.point(g,f)}function d(){p.point=m,r.lineEnd()}function b(){w(),p.point=M,p.lineEnd=A}function M(T,D){v(i=T,D),o=g,a=f,s=h,l=y,u=x,p.point=v}function A(){e(g,f,c,h,y,x,o,a,i,s,l,u,po,r),p.lineEnd=d,d()}return p}}var lh=ui({point:function(t,n){this.stream.point(t*yt,n*yt)}});function fh(t){return ui({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}function hh(t,n,e,r,i){function o(a,s){return a*=r,s*=i,[n+t*a,e-t*s]}return o.invert=function(a,s){return[(a-n)/t*r,(e-s)/t*i]},o}function yo(t,n,e,r,i,o){if(!o)return hh(t,n,e,r,i);var a=tt(o),s=j(o),l=a*t,u=s*t,c=a/t,g=s/t,f=(s*e-a*n)/t,h=(s*n+a*e)/t;function y(x,p){return x*=r,p*=i,[l*x-u*p+n,e-u*x-l*p]}return y.invert=function(x,p){return[r*(c*x-g*p+f),i*(h-g*x-c*p)]},y}function gh(t){return dh(function(){return t})()}function dh(t){var n,e=150,r=480,i=250,o=0,a=0,s=0,l=0,u=0,c,g=0,f=1,h=1,y=null,x=oo,p=null,m,w,v,d=zr,b=.5,M,A,T,D,k;function N(C){return T(C[0]*yt,C[1]*yt)}function $(C){return C=T.invert(C[0],C[1]),C&&[C[0]*zt,C[1]*zt]}N.stream=function(C){return D&&k===C?D:D=lh(fh(c)(x(M(d(k=C)))))},N.preclip=function(C){return arguments.length?(x=C,y=void 0,_()):x},N.postclip=function(C){return arguments.length?(d=C,p=m=w=v=null,_()):d},N.clipAngle=function(C){return arguments.length?(x=+C?Bf(y=C*yt):(y=null,oo),_()):y*zt},N.clipExtent=function(C){return arguments.length?(d=C==null?(p=m=w=v=null,zr):Wf(p=+C[0][0],m=+C[0][1],w=+C[1][0],v=+C[1][1]),_()):p==null?null:[[p,m],[w,v]]},N.scale=function(C){return arguments.length?(e=+C,H()):e},N.translate=function(C){return arguments.length?(r=+C[0],i=+C[1],H()):[r,i]},N.center=function(C){return arguments.length?(o=C[0]%360*yt,a=C[1]%360*yt,H()):[o*zt,a*zt]},N.rotate=function(C){return arguments.length?(s=C[0]%360*yt,l=C[1]%360*yt,u=C.length>2?C[2]%360*yt:0,H()):[s*zt,l*zt,u*zt]},N.angle=function(C){return arguments.length?(g=C%360*yt,H()):g*zt},N.reflectX=function(C){return arguments.length?(f=C?-1:1,H()):f<0},N.reflectY=function(C){return arguments.length?(h=C?-1:1,H()):h<0},N.precision=function(C){return arguments.length?(M=mo(A,b=C*C),_()):Zt(b)},N.fitExtent=function(C,S){return _a(N,C,S)},N.fitSize=function(C,S){return ih(N,C,S)},N.fitWidth=function(C,S){return oh(N,C,S)},N.fitHeight=function(C,S){return ah(N,C,S)};function H(){var C=yo(e,0,0,f,h,g).apply(null,n(o,a)),S=yo(e,r-C[0],i-C[1],f,h,g);return c=zf(s,l,u),A=$r(n,S),T=$r(c,A),M=mo(A,b),_()}function _(){return D=k=null,N}return function(){return n=t.apply(this,arguments),N.invert=n.invert&&$,H()}}function ph(t){return function(n,e){var r=Zt(n*n+e*e),i=t(r),o=j(i),a=tt(i);return[vn(n*o,r*a),Qt(r&&e*o/r)]}}function Ma(t,n){return[tt(n)*j(t),j(n)]}Ma.invert=ph(Qt);function mh(){return gh(Ma).scale(249.5).clipAngle(90+W)}function ba(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}function yh(t){return function(){return t}}function vh(t){return+t}var vo=[0,1];function ln(t){return t}function Wr(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:yh(isNaN(n)?NaN:.5)}function wh(t,n){var e;return t>n&&(e=t,t=n,n=e),function(r){return Math.max(t,Math.min(n,r))}}function xh(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=Wr(i,r),o=e(a,o)):(r=Wr(r,i),o=e(o,a)),function(s){return o(r(s))}}function _h(t,n,e){var r=Math.min(t.length,n.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<r;)i[a]=Wr(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(s){var l=Xa(t,s,1,r)-1;return o[l](i[l](s))}}function Ca(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Mh(){var t=vo,n=vo,e=Be,r,i,o,a=ln,s,l,u;function c(){var f=Math.min(t.length,n.length);return a!==ln&&(a=wh(t[0],t[f-1])),s=f>2?_h:xh,l=u=null,g}function g(f){return f==null||isNaN(f=+f)?o:(l||(l=s(t.map(r),n,e)))(r(a(f)))}return g.invert=function(f){return a(i((u||(u=s(n,t.map(r),St)))(f)))},g.domain=function(f){return arguments.length?(t=Array.from(f,vh),c()):t.slice()},g.range=function(f){return arguments.length?(n=Array.from(f),c()):n.slice()},g.rangeRound=function(f){return n=Array.from(f),e=hc,c()},g.clamp=function(f){return arguments.length?(a=f?!0:ln,c()):a!==ln},g.interpolate=function(f){return arguments.length?(e=f,c()):e},g.unknown=function(f){return arguments.length?(o=f,g):o},function(f,h){return r=f,i=h,c()}}function Sa(){return Mh()(ln,ln)}function bh(t,n,e,r){var i=mr(t,n,e),o;switch(r=Se(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(n));return r.precision==null&&!isNaN(o=Nf(i,a))&&(r.precision=o),aa(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Ef(i,Math.max(Math.abs(t),Math.abs(n))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=If(i))&&(r.precision=o-(r.type==="%")*2);break}}return si(r)}function Ch(t){var n=t.domain;return t.ticks=function(e){var r=n();return Oa(r[0],r[r.length-1],e??10)},t.tickFormat=function(e,r){var i=n();return bh(i[0],i[i.length-1],e??10,r)},t.nice=function(e){e==null&&(e=10);var r=n(),i=0,o=r.length-1,a=r[i],s=r[o],l,u,c=10;for(s<a&&(u=a,a=s,s=u,u=i,i=o,o=u);c-- >0;){if(u=pr(a,s,e),u===l)return r[i]=a,r[o]=s,n(r);if(u>0)a=Math.floor(a/u)*u,s=Math.ceil(s/u)*u;else if(u<0)a=Math.ceil(a*u)/u,s=Math.floor(s*u)/u;else break;l=u}return t},t}function Le(){var t=Sa();return t.copy=function(){return Ca(t,Le())},ba.apply(t,arguments),Ch(t)}function Sh(t,n){t=t.slice();var e=0,r=t.length-1,i=t[e],o=t[r],a;return o<i&&(a=e,e=r,r=a,a=i,i=o,o=a),t[e]=n.floor(i),t[r]=n.ceil(o),t}const sr=new Date,ur=new Date;function at(t,n,e,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),n(o,1),t(o),o),i.round=o=>{const a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(n(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{const l=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;let u;do l.push(u=new Date(+o)),n(o,s),t(o);while(u<o&&o<a);return l},i.filter=o=>at(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;n(a,-1),!o(a););else for(;--s>=0;)for(;n(a,1),!o(a););}),e&&(i.count=(o,a)=>(sr.setTime(+o),ur.setTime(+a),t(sr),t(ur),Math.floor(e(sr,ur))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const Fe=at(()=>{},(t,n)=>{t.setTime(+t+n)},(t,n)=>n-t);Fe.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?at(n=>{n.setTime(Math.floor(n/t)*t)},(n,e)=>{n.setTime(+n+e*t)},(n,e)=>(e-n)/t):Fe);Fe.range;const Ft=1e3,Mt=Ft*60,Ht=Mt*60,Yt=Ht*24,li=Yt*7,wo=Yt*30,cr=Yt*365,fn=at(t=>{t.setTime(t-t.getMilliseconds())},(t,n)=>{t.setTime(+t+n*Ft)},(t,n)=>(n-t)/Ft,t=>t.getUTCSeconds());fn.range;const fi=at(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ft)},(t,n)=>{t.setTime(+t+n*Mt)},(t,n)=>(n-t)/Mt,t=>t.getMinutes());fi.range;const Ah=at(t=>{t.setUTCSeconds(0,0)},(t,n)=>{t.setTime(+t+n*Mt)},(t,n)=>(n-t)/Mt,t=>t.getUTCMinutes());Ah.range;const hi=at(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Ft-t.getMinutes()*Mt)},(t,n)=>{t.setTime(+t+n*Ht)},(t,n)=>(n-t)/Ht,t=>t.getHours());hi.range;const Th=at(t=>{t.setUTCMinutes(0,0,0)},(t,n)=>{t.setTime(+t+n*Ht)},(t,n)=>(n-t)/Ht,t=>t.getUTCHours());Th.range;const qn=at(t=>t.setHours(0,0,0,0),(t,n)=>t.setDate(t.getDate()+n),(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Mt)/Yt,t=>t.getDate()-1);qn.range;const gi=at(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/Yt,t=>t.getUTCDate()-1);gi.range;const Ih=at(t=>{t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n)},(t,n)=>(n-t)/Yt,t=>Math.floor(t/Yt));Ih.range;function nn(t){return at(n=>{n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},(n,e)=>{n.setDate(n.getDate()+e*7)},(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*Mt)/li)}const Ge=nn(0),He=nn(1),Nh=nn(2),Eh=nn(3),_n=nn(4),kh=nn(5),$h=nn(6);Ge.range;He.range;Nh.range;Eh.range;_n.range;kh.range;$h.range;function en(t){return at(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e*7)},(n,e)=>(e-n)/li)}const Aa=en(0),Pe=en(1),Dh=en(2),zh=en(3),Mn=en(4),Lh=en(5),Fh=en(6);Aa.range;Pe.range;Dh.range;zh.range;Mn.range;Lh.range;Fh.range;const di=at(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,n)=>{t.setMonth(t.getMonth()+n)},(t,n)=>n.getMonth()-t.getMonth()+(n.getFullYear()-t.getFullYear())*12,t=>t.getMonth());di.range;const Hh=at(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCMonth(t.getUTCMonth()+n)},(t,n)=>n.getUTCMonth()-t.getUTCMonth()+(n.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Hh.range;const Rt=at(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n)},(t,n)=>n.getFullYear()-t.getFullYear(),t=>t.getFullYear());Rt.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:at(n=>{n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e*t)});Rt.range;const tn=at(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n)},(t,n)=>n.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());tn.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:at(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e*t)});tn.range;function Ph(t,n,e,r,i,o){const a=[[fn,1,Ft],[fn,5,5*Ft],[fn,15,15*Ft],[fn,30,30*Ft],[o,1,Mt],[o,5,5*Mt],[o,15,15*Mt],[o,30,30*Mt],[i,1,Ht],[i,3,3*Ht],[i,6,6*Ht],[i,12,12*Ht],[r,1,Yt],[r,2,2*Yt],[e,1,li],[n,1,wo],[n,3,3*wo],[t,1,cr]];function s(u,c,g){const f=c<u;f&&([u,c]=[c,u]);const h=g&&typeof g.range=="function"?g:l(u,c,g),y=h?h.range(u,+c+1):[];return f?y.reverse():y}function l(u,c,g){const f=Math.abs(c-u)/g,h=Vr(([,,p])=>p).right(a,f);if(h===a.length)return t.every(mr(u/cr,c/cr,g));if(h===0)return Fe.every(Math.max(mr(u,c,g),1));const[y,x]=a[f/a[h-1][2]<a[h][2]/f?h-1:h];return y.every(x)}return[s,l]}const[Uh,Yh]=Ph(Rt,di,Ge,qn,hi,fi);function lr(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function fr(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function An(t,n,e){return{y:t,m:n,d:e,H:0,M:0,S:0,L:0}}function Rh(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,l=t.shortMonths,u=Tn(i),c=In(i),g=Tn(o),f=In(o),h=Tn(a),y=In(a),x=Tn(s),p=In(s),m=Tn(l),w=In(l),v={a:I,A:F,b:z,B:L,c:null,d:So,e:So,f:l0,g:x0,G:M0,H:s0,I:u0,j:c0,L:Ta,m:f0,M:h0,p:U,q:Y,Q:Io,s:No,S:g0,u:d0,U:p0,V:m0,w:y0,W:v0,x:null,X:null,y:w0,Y:_0,Z:b0,"%":To},d={a:K,A:O,b:J,B:ct,c:null,d:Ao,e:Ao,f:T0,g:H0,G:U0,H:C0,I:S0,j:A0,L:Na,m:I0,M:N0,p:q,q:ut,Q:Io,s:No,S:E0,u:k0,U:$0,V:D0,w:z0,W:L0,x:null,X:null,y:F0,Y:P0,Z:Y0,"%":To},b={a:k,A:N,b:$,B:H,c:_,d:bo,e:bo,f:r0,g:Mo,G:_o,H:Co,I:Co,j:jh,L:e0,m:Qh,M:t0,p:D,q:Jh,Q:o0,s:a0,S:n0,u:Gh,U:Oh,V:Vh,w:Zh,W:qh,x:C,X:S,y:Mo,Y:_o,Z:Kh,"%":i0};v.x=M(e,v),v.X=M(r,v),v.c=M(n,v),d.x=M(e,d),d.X=M(r,d),d.c=M(n,d);function M(P,B){return function(X){var E=[],nt=-1,V=0,ht=P.length,gt,R,et;for(X instanceof Date||(X=new Date(+X));++nt<ht;)P.charCodeAt(nt)===37&&(E.push(P.slice(V,nt)),(R=xo[gt=P.charAt(++nt)])!=null?gt=P.charAt(++nt):R=gt==="e"?" ":"0",(et=B[gt])&&(gt=et(X,R)),E.push(gt),V=nt+1);return E.push(P.slice(V,nt)),E.join("")}}function A(P,B){return function(X){var E=An(1900,void 0,1),nt=T(E,P,X+="",0),V,ht;if(nt!=X.length)return null;if("Q"in E)return new Date(E.Q);if("s"in E)return new Date(E.s*1e3+("L"in E?E.L:0));if(B&&!("Z"in E)&&(E.Z=0),"p"in E&&(E.H=E.H%12+E.p*12),E.m===void 0&&(E.m="q"in E?E.q:0),"V"in E){if(E.V<1||E.V>53)return null;"w"in E||(E.w=1),"Z"in E?(V=fr(An(E.y,0,1)),ht=V.getUTCDay(),V=ht>4||ht===0?Pe.ceil(V):Pe(V),V=gi.offset(V,(E.V-1)*7),E.y=V.getUTCFullYear(),E.m=V.getUTCMonth(),E.d=V.getUTCDate()+(E.w+6)%7):(V=lr(An(E.y,0,1)),ht=V.getDay(),V=ht>4||ht===0?He.ceil(V):He(V),V=qn.offset(V,(E.V-1)*7),E.y=V.getFullYear(),E.m=V.getMonth(),E.d=V.getDate()+(E.w+6)%7)}else("W"in E||"U"in E)&&("w"in E||(E.w="u"in E?E.u%7:"W"in E?1:0),ht="Z"in E?fr(An(E.y,0,1)).getUTCDay():lr(An(E.y,0,1)).getDay(),E.m=0,E.d="W"in E?(E.w+6)%7+E.W*7-(ht+5)%7:E.w+E.U*7-(ht+6)%7);return"Z"in E?(E.H+=E.Z/100|0,E.M+=E.Z%100,fr(E)):lr(E)}}function T(P,B,X,E){for(var nt=0,V=B.length,ht=X.length,gt,R;nt<V;){if(E>=ht)return-1;if(gt=B.charCodeAt(nt++),gt===37){if(gt=B.charAt(nt++),R=b[gt in xo?B.charAt(nt++):gt],!R||(E=R(P,X,E))<0)return-1}else if(gt!=X.charCodeAt(E++))return-1}return E}function D(P,B,X){var E=u.exec(B.slice(X));return E?(P.p=c.get(E[0].toLowerCase()),X+E[0].length):-1}function k(P,B,X){var E=h.exec(B.slice(X));return E?(P.w=y.get(E[0].toLowerCase()),X+E[0].length):-1}function N(P,B,X){var E=g.exec(B.slice(X));return E?(P.w=f.get(E[0].toLowerCase()),X+E[0].length):-1}function $(P,B,X){var E=m.exec(B.slice(X));return E?(P.m=w.get(E[0].toLowerCase()),X+E[0].length):-1}function H(P,B,X){var E=x.exec(B.slice(X));return E?(P.m=p.get(E[0].toLowerCase()),X+E[0].length):-1}function _(P,B,X){return T(P,n,B,X)}function C(P,B,X){return T(P,e,B,X)}function S(P,B,X){return T(P,r,B,X)}function I(P){return a[P.getDay()]}function F(P){return o[P.getDay()]}function z(P){return l[P.getMonth()]}function L(P){return s[P.getMonth()]}function U(P){return i[+(P.getHours()>=12)]}function Y(P){return 1+~~(P.getMonth()/3)}function K(P){return a[P.getUTCDay()]}function O(P){return o[P.getUTCDay()]}function J(P){return l[P.getUTCMonth()]}function ct(P){return s[P.getUTCMonth()]}function q(P){return i[+(P.getUTCHours()>=12)]}function ut(P){return 1+~~(P.getUTCMonth()/3)}return{format:function(P){var B=M(P+="",v);return B.toString=function(){return P},B},parse:function(P){var B=A(P+="",!1);return B.toString=function(){return P},B},utcFormat:function(P){var B=M(P+="",d);return B.toString=function(){return P},B},utcParse:function(P){var B=A(P+="",!0);return B.toString=function(){return P},B}}}var xo={"-":"",_:" ",0:"0"},st=/^\s*\d+/,Bh=/^%/,Xh=/[\\^$*+?|[\]().{}]/g;function G(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function Wh(t){return t.replace(Xh,"\\$&")}function Tn(t){return new RegExp("^(?:"+t.map(Wh).join("|")+")","i")}function In(t){return new Map(t.map((n,e)=>[n.toLowerCase(),e]))}function Zh(t,n,e){var r=st.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function Gh(t,n,e){var r=st.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function Oh(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function Vh(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function qh(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function _o(t,n,e){var r=st.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function Mo(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function Kh(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function Jh(t,n,e){var r=st.exec(n.slice(e,e+1));return r?(t.q=r[0]*3-3,e+r[0].length):-1}function Qh(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function bo(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function jh(t,n,e){var r=st.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function Co(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function t0(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function n0(t,n,e){var r=st.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function e0(t,n,e){var r=st.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function r0(t,n,e){var r=st.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function i0(t,n,e){var r=Bh.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function o0(t,n,e){var r=st.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function a0(t,n,e){var r=st.exec(n.slice(e));return r?(t.s=+r[0],e+r[0].length):-1}function So(t,n){return G(t.getDate(),n,2)}function s0(t,n){return G(t.getHours(),n,2)}function u0(t,n){return G(t.getHours()%12||12,n,2)}function c0(t,n){return G(1+qn.count(Rt(t),t),n,3)}function Ta(t,n){return G(t.getMilliseconds(),n,3)}function l0(t,n){return Ta(t,n)+"000"}function f0(t,n){return G(t.getMonth()+1,n,2)}function h0(t,n){return G(t.getMinutes(),n,2)}function g0(t,n){return G(t.getSeconds(),n,2)}function d0(t){var n=t.getDay();return n===0?7:n}function p0(t,n){return G(Ge.count(Rt(t)-1,t),n,2)}function Ia(t){var n=t.getDay();return n>=4||n===0?_n(t):_n.ceil(t)}function m0(t,n){return t=Ia(t),G(_n.count(Rt(t),t)+(Rt(t).getDay()===4),n,2)}function y0(t){return t.getDay()}function v0(t,n){return G(He.count(Rt(t)-1,t),n,2)}function w0(t,n){return G(t.getFullYear()%100,n,2)}function x0(t,n){return t=Ia(t),G(t.getFullYear()%100,n,2)}function _0(t,n){return G(t.getFullYear()%1e4,n,4)}function M0(t,n){var e=t.getDay();return t=e>=4||e===0?_n(t):_n.ceil(t),G(t.getFullYear()%1e4,n,4)}function b0(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+G(n/60|0,"0",2)+G(n%60,"0",2)}function Ao(t,n){return G(t.getUTCDate(),n,2)}function C0(t,n){return G(t.getUTCHours(),n,2)}function S0(t,n){return G(t.getUTCHours()%12||12,n,2)}function A0(t,n){return G(1+gi.count(tn(t),t),n,3)}function Na(t,n){return G(t.getUTCMilliseconds(),n,3)}function T0(t,n){return Na(t,n)+"000"}function I0(t,n){return G(t.getUTCMonth()+1,n,2)}function N0(t,n){return G(t.getUTCMinutes(),n,2)}function E0(t,n){return G(t.getUTCSeconds(),n,2)}function k0(t){var n=t.getUTCDay();return n===0?7:n}function $0(t,n){return G(Aa.count(tn(t)-1,t),n,2)}function Ea(t){var n=t.getUTCDay();return n>=4||n===0?Mn(t):Mn.ceil(t)}function D0(t,n){return t=Ea(t),G(Mn.count(tn(t),t)+(tn(t).getUTCDay()===4),n,2)}function z0(t){return t.getUTCDay()}function L0(t,n){return G(Pe.count(tn(t)-1,t),n,2)}function F0(t,n){return G(t.getUTCFullYear()%100,n,2)}function H0(t,n){return t=Ea(t),G(t.getUTCFullYear()%100,n,2)}function P0(t,n){return G(t.getUTCFullYear()%1e4,n,4)}function U0(t,n){var e=t.getUTCDay();return t=e>=4||e===0?Mn(t):Mn.ceil(t),G(t.getUTCFullYear()%1e4,n,4)}function Y0(){return"+0000"}function To(){return"%"}function Io(t){return+t}function No(t){return Math.floor(+t/1e3)}var an,pi;R0({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function R0(t){return an=Rh(t),pi=an.format,an.parse,an.utcFormat,an.utcParse,an}function B0(t){return new Date(t)}function X0(t){return t instanceof Date?+t:+new Date(+t)}function ka(t,n,e,r,i,o,a,s,l,u){var c=Sa(),g=c.invert,f=c.domain,h=u(".%L"),y=u(":%S"),x=u("%I:%M"),p=u("%I %p"),m=u("%a %d"),w=u("%b %d"),v=u("%B"),d=u("%Y");function b(M){return(l(M)<M?h:s(M)<M?y:a(M)<M?x:o(M)<M?p:r(M)<M?i(M)<M?m:w:e(M)<M?v:d)(M)}return c.invert=function(M){return new Date(g(M))},c.domain=function(M){return arguments.length?f(Array.from(M,X0)):f().map(B0)},c.ticks=function(M){var A=f();return t(A[0],A[A.length-1],M??10)},c.tickFormat=function(M,A){return A==null?b:u(A)},c.nice=function(M){var A=f();return(!M||typeof M.range!="function")&&(M=n(A[0],A[A.length-1],M??10)),M?f(Sh(A,M)):c},c.copy=function(){return Ca(c,ka(t,n,e,r,i,o,a,s,l,u))},c}function W0(){return ba.apply(ka(Uh,Yh,Rt,di,Ge,qn,hi,fi,fn,pi).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}const se=t=>()=>t;function Z0(t,{sourceEvent:n,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Pt(t,n,e){this.k=t,this.x=n,this.y=e}Pt.prototype={constructor:Pt,scale:function(t){return t===1?this:new Pt(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Pt(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var $a=new Pt(1,0,0);Pt.prototype;function hr(t){t.stopImmediatePropagation()}function Nn(t){t.preventDefault(),t.stopImmediatePropagation()}function G0(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function O0(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Eo(){return this.__zoom||$a}function V0(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function q0(){return navigator.maxTouchPoints||"ontouchstart"in this}function K0(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function Da(){var t=G0,n=O0,e=K0,r=V0,i=q0,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,l=xc,u=bn("start","zoom","end"),c,g,f,h=500,y=150,x=0,p=10;function m(_){_.property("__zoom",Eo).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",k).filter(i).on("touchstart.zoom",N).on("touchmove.zoom",$).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(_,C,S,I){var F=_.selection?_.selection():_;F.property("__zoom",Eo),_!==F?b(_,C,S,I):F.interrupt().each(function(){M(this,arguments).event(I).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},m.scaleBy=function(_,C,S,I){m.scaleTo(_,function(){var F=this.__zoom.k,z=typeof C=="function"?C.apply(this,arguments):C;return F*z},S,I)},m.scaleTo=function(_,C,S,I){m.transform(_,function(){var F=n.apply(this,arguments),z=this.__zoom,L=S==null?d(F):typeof S=="function"?S.apply(this,arguments):S,U=z.invert(L),Y=typeof C=="function"?C.apply(this,arguments):C;return e(v(w(z,Y),L,U),F,a)},S,I)},m.translateBy=function(_,C,S,I){m.transform(_,function(){return e(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof S=="function"?S.apply(this,arguments):S),n.apply(this,arguments),a)},null,I)},m.translateTo=function(_,C,S,I,F){m.transform(_,function(){var z=n.apply(this,arguments),L=this.__zoom,U=I==null?d(z):typeof I=="function"?I.apply(this,arguments):I;return e($a.translate(U[0],U[1]).scale(L.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof S=="function"?-S.apply(this,arguments):-S),z,a)},I,F)};function w(_,C){return C=Math.max(o[0],Math.min(o[1],C)),C===_.k?_:new Pt(C,_.x,_.y)}function v(_,C,S){var I=C[0]-S[0]*_.k,F=C[1]-S[1]*_.k;return I===_.x&&F===_.y?_:new Pt(_.k,I,F)}function d(_){return[(+_[0][0]+ +_[1][0])/2,(+_[0][1]+ +_[1][1])/2]}function b(_,C,S,I){_.on("start.zoom",function(){M(this,arguments).event(I).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(I).end()}).tween("zoom",function(){var F=this,z=arguments,L=M(F,z).event(I),U=n.apply(F,z),Y=S==null?d(U):typeof S=="function"?S.apply(F,z):S,K=Math.max(U[1][0]-U[0][0],U[1][1]-U[0][1]),O=F.__zoom,J=typeof C=="function"?C.apply(F,z):C,ct=l(O.invert(Y).concat(K/O.k),J.invert(Y).concat(K/J.k));return function(q){if(q===1)q=J;else{var ut=ct(q),P=K/ut[2];q=new Pt(P,Y[0]-ut[0]*P,Y[1]-ut[1]*P)}L.zoom(null,q)}})}function M(_,C,S){return!S&&_.__zooming||new A(_,C)}function A(_,C){this.that=_,this.args=C,this.active=0,this.sourceEvent=null,this.extent=n.apply(_,C),this.taps=0}A.prototype={event:function(_){return _&&(this.sourceEvent=_),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(_,C){return this.mouse&&_!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&_!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&_!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(_){var C=ot(this.that).datum();u.call(_,this.that,new Z0(_,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:u}),C)}};function T(_,...C){if(!t.apply(this,arguments))return;var S=M(this,C).event(_),I=this.__zoom,F=Math.max(o[0],Math.min(o[1],I.k*Math.pow(2,r.apply(this,arguments)))),z=Ct(_);if(S.wheel)(S.mouse[0][0]!==z[0]||S.mouse[0][1]!==z[1])&&(S.mouse[1]=I.invert(S.mouse[0]=z)),clearTimeout(S.wheel);else{if(I.k===F)return;S.mouse=[z,I.invert(z)],dn(this),S.start()}Nn(_),S.wheel=setTimeout(L,y),S.zoom("mouse",e(v(w(I,F),S.mouse[0],S.mouse[1]),S.extent,a));function L(){S.wheel=null,S.end()}}function D(_,...C){if(f||!t.apply(this,arguments))return;var S=_.currentTarget,I=M(this,C,!0).event(_),F=ot(_.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",K,!0),z=Ct(_,S),L=_.clientX,U=_.clientY;Jr(_.view),hr(_),I.mouse=[z,this.__zoom.invert(z)],dn(this),I.start();function Y(O){if(Nn(O),!I.moved){var J=O.clientX-L,ct=O.clientY-U;I.moved=J*J+ct*ct>x}I.event(O).zoom("mouse",e(v(I.that.__zoom,I.mouse[0]=Ct(O,S),I.mouse[1]),I.extent,a))}function K(O){F.on("mousemove.zoom mouseup.zoom",null),Qr(O.view,I.moved),Nn(O),I.event(O).end()}}function k(_,...C){if(t.apply(this,arguments)){var S=this.__zoom,I=Ct(_.changedTouches?_.changedTouches[0]:_,this),F=S.invert(I),z=S.k*(_.shiftKey?.5:2),L=e(v(w(S,z),I,F),n.apply(this,C),a);Nn(_),s>0?ot(this).transition().duration(s).call(b,L,I,_):ot(this).call(m.transform,L,I,_)}}function N(_,...C){if(t.apply(this,arguments)){var S=_.touches,I=S.length,F=M(this,C,_.changedTouches.length===I).event(_),z,L,U,Y;for(hr(_),L=0;L<I;++L)U=S[L],Y=Ct(U,this),Y=[Y,this.__zoom.invert(Y),U.identifier],F.touch0?!F.touch1&&F.touch0[2]!==Y[2]&&(F.touch1=Y,F.taps=0):(F.touch0=Y,z=!0,F.taps=1+!!c);c&&(c=clearTimeout(c)),z&&(F.taps<2&&(g=Y[0],c=setTimeout(function(){c=null},h)),dn(this),F.start())}}function $(_,...C){if(this.__zooming){var S=M(this,C).event(_),I=_.changedTouches,F=I.length,z,L,U,Y;for(Nn(_),z=0;z<F;++z)L=I[z],U=Ct(L,this),S.touch0&&S.touch0[2]===L.identifier?S.touch0[0]=U:S.touch1&&S.touch1[2]===L.identifier&&(S.touch1[0]=U);if(L=S.that.__zoom,S.touch1){var K=S.touch0[0],O=S.touch0[1],J=S.touch1[0],ct=S.touch1[1],q=(q=J[0]-K[0])*q+(q=J[1]-K[1])*q,ut=(ut=ct[0]-O[0])*ut+(ut=ct[1]-O[1])*ut;L=w(L,Math.sqrt(q/ut)),U=[(K[0]+J[0])/2,(K[1]+J[1])/2],Y=[(O[0]+ct[0])/2,(O[1]+ct[1])/2]}else if(S.touch0)U=S.touch0[0],Y=S.touch0[1];else return;S.zoom("touch",e(v(L,U,Y),S.extent,a))}}function H(_,...C){if(this.__zooming){var S=M(this,C).event(_),I=_.changedTouches,F=I.length,z,L;for(hr(_),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),z=0;z<F;++z)L=I[z],S.touch0&&S.touch0[2]===L.identifier?delete S.touch0:S.touch1&&S.touch1[2]===L.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(L=Ct(L,this),Math.hypot(g[0]-L[0],g[1]-L[1])<p)){var U=ot(this).on("dblclick.zoom");U&&U.apply(this,arguments)}}}return m.wheelDelta=function(_){return arguments.length?(r=typeof _=="function"?_:se(+_),m):r},m.filter=function(_){return arguments.length?(t=typeof _=="function"?_:se(!!_),m):t},m.touchable=function(_){return arguments.length?(i=typeof _=="function"?_:se(!!_),m):i},m.extent=function(_){return arguments.length?(n=typeof _=="function"?_:se([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),m):n},m.scaleExtent=function(_){return arguments.length?(o[0]=+_[0],o[1]=+_[1],m):[o[0],o[1]]},m.translateExtent=function(_){return arguments.length?(a[0][0]=+_[0][0],a[1][0]=+_[1][0],a[0][1]=+_[0][1],a[1][1]=+_[1][1],m):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},m.constrain=function(_){return arguments.length?(e=_,m):e},m.duration=function(_){return arguments.length?(s=+_,m):s},m.interpolate=function(_){return arguments.length?(l=_,m):l},m.on=function(){var _=u.on.apply(u,arguments);return _===u?m:_},m.clickDistance=function(_){return arguments.length?(x=(_=+_)*_,m):Math.sqrt(x)},m.tapDistance=function(_){return arguments.length?(p=+_,m):p},m}const ue={pc:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2 M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z",server:"M2 20h20 M2 4h20 M2 12h20 M2 4v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z M6 8h.01 M6 16h.01",router:"M22 12h-4l-3 9L9 3l-3 9H2",globe:"M22 12A10 10 0 1 1 12 2a10 10 0 0 1 10 10z M2 12h20 M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1 4-10z"};function J0(t,n,e,r){const i=document.getElementById(n);if(!i)return;const o=i.clientWidth||800,a=i.clientHeight||600;i.innerHTML="";const s=document.getElementById("graph-context-menu");s&&s.remove();const l=new Map;t.forEach(d=>{l.has(d.source)||l.set(d.source,{id:d.source,value:0,connections:0}),l.has(d.target)||l.set(d.target,{id:d.target,value:0,connections:0}),l.get(d.source).value+=d.value,l.get(d.source).connections+=1,l.get(d.target).value+=d.value,l.get(d.target).connections+=1});const u=Array.from(l.values()).map(d=>({...d,type:tg(d.id,d.connections)})),c=t.map(d=>({source:d.source,target:d.target,value:d.value,protocol:Q0(d.protocolCounts)})),g=ot(i).append("svg").attr("width",o).attr("height",a).attr("viewBox",[0,0,o,a]).style("background","transparent"),h=g.append("defs").append("filter").attr("id","glow");h.append("feGaussianBlur").attr("stdDeviation","2.5").attr("result","coloredBlur");const y=h.append("feMerge");y.append("feMergeNode").attr("in","coloredBlur"),y.append("feMergeNode").attr("in","SourceGraphic");const x=vf(u).force("link",lf(c).id(d=>d.id).distance(120)).force("charge",wf().strength(-300)).force("center",Bl(o/2,a/2)).force("collide",uf().radius(d=>(d.value?30:15)+10).iterations(2)),p=g.append("g"),m=p.append("g").attr("stroke-opacity",.6).selectAll("line").data(c).join("line").attr("stroke",d=>j0(d.protocol)).attr("stroke-width",d=>Math.min(Math.sqrt(d.value)/100,2)+.5).attr("class","graph-link").style("filter","url(#glow)"),w=p.append("g").selectAll("g").data(u).join("g").attr("class","node-group").attr("cursor","pointer").call(eg(x));w.filter(d=>d.type==="server"||d.type==="gateway").append("circle").attr("r",25).attr("fill",d=>gr(d.type)).attr("opacity",.15).attr("class","halo"),w.append("circle").attr("r",14).attr("fill","var(--bg-deep)").attr("stroke",d=>gr(d.type)).attr("stroke-width",2).style("filter","url(#glow)"),w.append("path").attr("d",d=>ng(d.type)).attr("fill","none").attr("stroke",d=>gr(d.type)).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("transform","scale(0.8) translate(-12, -12)"),w.append("text").text(d=>d.id).attr("x",0).attr("y",30).attr("text-anchor","middle").attr("class","graph-label").style("fill","var(--text-scifi)").style("font-family","var(--font-mono)").style("font-size","10px").style("opacity",.8),w.on("click",(d,b)=>{d.stopPropagation(),e&&e("node",b),Ue(),w.selectAll("circle").attr("stroke-width",2),ot(d.currentTarget).select("circle").attr("stroke-width",4)}),w.on("contextmenu",(d,b)=>{d.preventDefault(),rg(d,b,e,r)}),g.on("click",()=>{e&&e(null,null),Ue(),w.selectAll("circle").attr("stroke-width",2)});const v=Da().scaleExtent([.1,4]).on("zoom",d=>{p.attr("transform",d.transform)});g.call(v),x.on("tick",()=>{m.attr("x1",d=>d.source.x).attr("y1",d=>d.source.y).attr("x2",d=>d.target.x).attr("y2",d=>d.target.y),w.attr("transform",d=>`translate(${d.x},${d.y})`)})}function Q0(t){if(!t)return"other";let n=0,e="other";for(const[r,i]of Object.entries(t))i>n&&(n=i,e=r);return e}function j0(t){switch(t){case"TCP":return"var(--accent-blue)";case"UDP":return"var(--accent-success)";case"ICMP":return"var(--accent-warn)";default:return"var(--text-secondary)"}}function tg(t,n){return t.endsWith(".1")||t.endsWith(".254")?"gateway":n>5?"server":!t.startsWith("192.")&&!t.startsWith("10.")&&!t.startsWith("172.")?"wan":"pc"}function gr(t){switch(t){case"gateway":return"var(--accent-warn)";case"server":return"var(--accent-magenta)";case"wan":return"var(--accent-cyan)";default:return"var(--accent-blue)"}}function ng(t){switch(t){case"gateway":return ue.router;case"server":return ue.server;case"wan":return ue.globe;default:return ue.pc}}function eg(t){function n(i){i.active||t.alphaTarget(.3).restart(),i.subject.fx=i.subject.x,i.subject.fy=i.subject.y}function e(i){i.subject.fx=i.x,i.subject.fy=i.y}function r(i){i.active||t.alphaTarget(0),i.subject.fx=null,i.subject.fy=null}return Xu().on("start",n).on("drag",e).on("end",r)}function rg(t,n,e,r){Ue();const i=document.createElement("div");i.id="graph-context-menu",i.className="glass-panel",i.style.position="absolute",i.style.left=`${t.pageX}px`,i.style.top=`${t.pageY}px`,i.style.padding="5px 0",i.style.zIndex="1000",[{label:"Focus Node",action:()=>e("node",n)},{label:"Hide Node",action:()=>r(n.id)}].forEach(a=>{const s=document.createElement("div");s.textContent=a.label,s.style.padding="8px 16px",s.style.cursor="pointer",s.style.color="var(--text-primary)",s.onmouseover=()=>s.style.background="rgba(255,255,255,0.1)",s.onmouseout=()=>s.style.background="transparent",s.onclick=()=>{a.action(),Ue()},i.appendChild(s)}),document.body.appendChild(i)}function Ue(){const t=document.getElementById("graph-context-menu");t&&t.remove()}function ig(t,n){let e=t.payload;if(!e&&t.udp&&(e=t.udp.payload),n.innerHTML="",!e||e.length===0){n.innerHTML='<div style="padding:1rem; color:var(--text-secondary);">No payload data available.</div>';return}const r=document.createElement("div");r.className="hex-editor-view",r.style.display="grid",r.style.gridTemplateColumns="60px 1fr 1fr",r.style.gap="1rem",r.style.fontFamily="var(--font-mono)",r.style.fontSize="0.8rem",r.style.lineHeight="1.5em",r.style.color="var(--text-secondary)";const i=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");i.style.color="var(--accent-cyan)",i.style.textAlign="right",i.style.borderRight="1px solid var(--border-neon)",i.style.paddingRight="8px";const s=e,l=[];for(let h=0;h<s.length;h+=2)l.push(parseInt(s.substr(h,2),16));let u="",c="",g="";for(let h=0;h<l.length;h+=16){u+=`<div>${h.toString(16).padStart(4,"0")}</div>`;const y=l.slice(h,h+16),x=y.map((m,w)=>`<span class="byte-hex" data-idx="${h+w}">${m.toString(16).padStart(2,"0")}</span>`).join(" ");c+=`<div>${x}</div>`;const p=y.map((m,w)=>{const v=m>=32&&m<=126?String.fromCharCode(m):".";return`<span class="byte-ascii" data-idx="${h+w}">${og(v)}</span>`}).join("");g+=`<div>${p}</div>`}i.innerHTML=u,o.innerHTML=c,a.innerHTML=g,r.appendChild(i),r.appendChild(o),r.appendChild(a),n.appendChild(r),o.querySelectorAll(".byte-hex"),a.querySelectorAll(".byte-ascii");function f(h,y){const x=o.querySelector(`.byte-hex[data-idx="${h}"]`),p=a.querySelector(`.byte-ascii[data-idx="${h}"]`),m=y?"var(--accent-blue)":"";x&&(x.style.color=y?"#fff":"",x.style.background=m),p&&(p.style.color=y?"#fff":"",p.style.background=m)}r.addEventListener("mouseover",h=>{h.target.dataset.idx&&f(h.target.dataset.idx,!0)}),r.addEventListener("mouseout",h=>{h.target.dataset.idx&&f(h.target.dataset.idx,!1)})}function og(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ag(t,n,e=[]){const r=document.getElementById(n);if(!r)return;let i=document.getElementById("packet-table-body"),o=r.querySelector(".packet-table-wrapper");if(!i||r.innerHTML===""){r.innerHTML=`
            <div class="packet-list-container">
                <div class="packet-list-header">
                    <div style="font-weight:600; color:var(--text-primary)">Packet Capture</div>
                    <div class="packet-count" style="color:var(--text-secondary)">${t.length.toLocaleString()} events</div>
                </div>
                <div class="packet-table-wrapper" style="overflow-y:auto; flex:1; position:relative;">
                    <table class="packet-table" style="position:absolute; top:0; left:0; width:100%;">
                        <thead>
                            <tr style="height:32px;"> 
                                <th style="width:60px">No.</th>
                                <th style="width:100px">Time</th>
                                <th style="width:140px">Source</th>
                                <th style="width:140px">Destination</th>
                                <th style="width:80px">Proto</th>
                                <th style="width:80px">Len</th>
                                <th>Info</th>
                            </tr>
                        </thead>
                        <tbody id="packet-table-body"></tbody>
                    </table>
                    <div id="virtual-scroller-spacer" style="width:1px;"></div>
                </div>
            </div>
        `,i=document.getElementById("packet-table-body"),o=r.querySelector(".packet-table-wrapper"),o.addEventListener("scroll",()=>{dr(t,i,o)});const s=t.length*32;document.getElementById("virtual-scroller-spacer").style.height=`${s+32}px`,dr(t,i,o)}else{r.querySelector(".packet-count").textContent=`${t.length.toLocaleString()} events`;const s=t.length*32;document.getElementById("virtual-scroller-spacer").style.height=`${s+32}px`,dr(t,i,o)}}function dr(t,n,e){var g,f;const i=e.clientHeight,o=e.scrollTop;let a=Math.floor(o/32),s=Math.ceil((o+i)/32);a=Math.max(0,a-10),s=Math.min(t.length,s+10);const l=a*32,u=n.parentElement;n.innerHTML="",u.style.transform=`translateY(${l}px)`;const c=document.createDocumentFragment();for(let h=a;h<s;h++){const y=t[h];if(!y)continue;const x=document.createElement("tr");x.style.height="32px",x.dataset.index=h;let p="ETH",m="default";y.tcp?(p="TCP",m="proto-tcp"):y.udp?(p="UDP",m="proto-udp"):y.icmp?(p="ICMP",m="proto-icmp"):y.app&&(p=y.app.type);let w="";if(y.app)w=y.app.info;else if(y.tcp){const v=[];y.tcp.syn&&v.push("SYN"),y.tcp.ack&&v.push("ACK"),y.tcp.fin&&v.push("FIN"),y.tcp.rst&&v.push("RST"),w=`${y.tcp.src_port}  ${y.tcp.dst_port} [${v.join(",")}] Seq=${y.tcp.seq}`}else y.udp&&(w=`${y.udp.src_port}  ${y.udp.dst_port} Len=${y.udp.length}`);w.length>80&&(w=w.substring(0,80)+"..."),x.innerHTML=`
            <td>${h+1}</td>
            <td>${(y.timestamp/1e6).toFixed(6)}</td>
            <td>${((g=y.ip)==null?void 0:g.src)||"L2"}</td>
            <td>${((f=y.ip)==null?void 0:f.dst)||"L2"}</td>
            <td><span class="badge-proto ${m}">${p}</span></td>
            <td>${y.length}</td>
            <td>${sg(w)}</td>
        `,x.onclick=()=>{n.querySelectorAll(".selected").forEach(v=>v.classList.remove("selected")),x.classList.add("selected"),window.dispatchEvent(new CustomEvent("packet-selected",{detail:y}))},c.appendChild(x)}n.appendChild(c)}function sg(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function ug(t,n,e){const r=document.getElementById(n);if(!r||(r.innerHTML="",t.length===0))return;const i={top:10,right:20,bottom:25,left:50},o=r.clientWidth-i.left-i.right,a=r.clientHeight-i.top-i.bottom,s=t[0].timestamp,l=t[t.length-1].timestamp,u=l-s;if(u<=0)return;const c=Math.min(120,Math.max(40,o/10)),g=u/c,f=new Array(Math.ceil(c)).fill(0),h=[];for(let M=0;M<f.length;M++)h.push(s+M*g);t.forEach(M=>{const A=Math.min(Math.floor((M.timestamp-s)/g),c-1);f[A]+=M.length});const y=Math.max(...f),x=ot(r).append("svg").attr("width",o+i.left+i.right).attr("height",a+i.top+i.bottom).append("g").attr("transform",`translate(${i.left},${i.top})`),p=W0().domain([new Date(s*1e3),new Date(l*1e3)]).range([0,o]),m=Le().domain([0,y]).range([a,0]),w=vr(p).ticks(o/100).tickFormat(pi("%H:%M:%S")),v=wr(m).ticks(4).tickFormat(M=>cg(M,0)),d=x.append("g").attr("class","axis axis-x").attr("transform",`translate(0,${a})`).call(w);d.selectAll("text").style("fill","var(--text-secondary)").style("font-family","var(--font-mono)"),d.selectAll("line").style("stroke","var(--border-neon)"),d.selectAll("path").style("stroke","var(--border-neon)");const b=x.append("g").attr("class","axis axis-y").call(v);if(b.selectAll("text").style("fill","var(--text-secondary)").style("font-family","var(--font-mono)"),b.selectAll("line").style("stroke","var(--border-neon)"),b.selectAll("path").style("stroke","var(--border-neon)"),x.selectAll("rect").data(f).join("rect").attr("x",(M,A)=>p(new Date(h[A]*1e3))).attr("y",M=>m(M)).attr("width",Math.max(1,o/c-2)).attr("height",M=>a-m(M)).attr("fill","var(--accent-cyan)").attr("opacity",.6).on("mouseover",function(){ot(this).attr("opacity",1).attr("fill","var(--accent-magenta)")}).on("mouseout",function(){ot(this).attr("opacity",.6).attr("fill","var(--accent-cyan)")}),e){const M=Yl().extent([[0,0],[o,a]]).on("end",T=>{if(!T.selection){e(null,null);return}const[D,k]=T.selection,N=p.invert(D).getTime()/1e3,$=p.invert(k).getTime()/1e3;e(N,$)});x.append("g").attr("class","brush").call(M).selectAll(".selection").style("fill","var(--accent-cyan)").style("fill-opacity","0.2").style("stroke","var(--accent-cyan)")}}function cg(t,n=2){if(t===0)return"0 B";const e=1024,r=["B","KB","MB","GB","TB"],i=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,i)).toFixed(n))+" "+r[i]}class lg{static followTcpStream(n,e){if(!n.tcp||!n.ip)throw new Error("Not a TCP packet");const r=n.ip.src,i=n.ip.dst,o=n.tcp.src_port,a=n.tcp.dst_port,s=e.filter(c=>{if(!c.tcp||!c.ip)return!1;const g=c.ip.src,f=c.ip.dst,h=c.tcp.src_port,y=c.tcp.dst_port;return g===r&&f===i&&h===o&&y===a||g===i&&f===r&&h===a&&y===o});s.sort((c,g)=>c.timestamp-g.timestamp);let l="",u="";return s.forEach(c=>{if(c.payload&&c.payload.length>0){const g=c.ip.src===r,f=g?"stream-req":"stream-res",h=g?"color: #fca5a5;":"color: #93c5fd;",y=this.hexToBytes(c.payload),x=this.bytesToAscii(y);l+=x,u+=`<span class="${f}" style="${h}">${this.escapeHtml(x)}</span>`}}),{id:`${r}:${o}-${i}:${a}`,packets:s,text:l,html:u}}static hexToBytes(n){if(!n)return[];const e=[];for(let r=0;r<n.length;r+=2)e.push(parseInt(n.substr(r,2),16));return e}static bytesToAscii(n){return n.map(e=>e>=32&&e<=126||e===10||e===13||e===9?String.fromCharCode(e):".").join("")}static escapeHtml(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}function fg(t,n){const e=document.getElementById(n);if(!e)return;e.innerHTML="";const r=t.packets;if(r.length===0)return;const i={top:20,right:30,bottom:40,left:60},o=e.clientWidth-i.left-i.right,a=e.clientHeight-i.top-i.bottom,s=r[0].timestamp,l=r.map(b=>({relTime:b.timestamp-s,seq:b.tcp?b.tcp.seq:0,len:b.payload?b.payload.length/2:0,direction:b.ip.src===r[0].ip.src?"out":"in",packet:b})),u=ot(e).append("svg").attr("width",o+i.left+i.right).attr("height",a+i.top+i.bottom),c=u.append("g").attr("transform",`translate(${i.left},${i.top})`),g=Le().domain([0,vi(l,b=>b.relTime)]).range([0,o]),f=Le().domain([Va(l,b=>b.seq),vi(l,b=>b.seq+b.len)]).range([a,0]),h=vr(g).tickFormat(b=>(b/1e6).toFixed(2)+"s"),y=wr(f).tickFormat(si(".2s")),x=()=>vr(g).ticks(10),p=()=>wr(f).ticks(10);c.append("g").attr("class","grid").attr("transform",`translate(0,${a})`).call(x().tickSize(-a).tickFormat("")),c.append("g").attr("class","grid").call(p().tickSize(-o).tickFormat(""));const m=c.append("g").attr("transform",`translate(0,${a})`).call(h),w=c.append("g").call(y);c.selectAll("text").attr("fill","var(--text-secondary)").style("font-family","var(--font-mono)"),c.selectAll(".domain").attr("stroke","var(--border-neon)"),c.selectAll(".tick line").attr("stroke","rgba(255,255,255,0.05)"),c.selectAll("circle").data(l).join("circle").attr("cx",b=>g(b.relTime)).attr("cy",b=>f(b.seq)).attr("r",3).attr("fill",b=>b.direction==="out"?"var(--accent-danger)":"var(--accent-blue)").attr("opacity",.8).append("title").text(b=>`Seq: ${b.seq}
Len: ${b.len}`);const v=Da().scaleExtent([.5,20]).extent([[0,0],[o,a]]).on("zoom",d);u.call(v);function d(b){const M=b.transform.rescaleX(g),A=b.transform.rescaleY(f);m.call(h.scale(M)),w.call(y.scale(A)),c.selectAll("circle").attr("cx",T=>M(T.relTime)).attr("cy",T=>A(T.seq)),c.selectAll(".grid").attr("opacity",b.transform.k>.8?.2:0)}}class hg{static scan(n){const e=[],o=new Map;return n.forEach(a=>{if(a.tcp&&a.tcp.syn&&!a.tcp.ack){const s=a.ip.src;o.has(s)||o.set(s,new Set),o.get(s).add(a.tcp.dst_port)}a.udp&&a.udp.dst_port===53&&a.app&&a.app.type==="DNS"&&(a.app.info||"").split(" ").forEach(u=>{u.includes(".")&&u.length>50&&e.push({type:"DNS Tunneling Suspected",severity:"High",source:a.ip.src,target:a.ip.dst,details:`Suspiciously long query: ${u.substring(0,30)}...`,timestamp:a.timestamp})})}),o.forEach((a,s)=>{var l;a.size>20&&e.push({type:"Port Scan Detected",severity:"Medium",source:s,target:"Multiple",details:`Scanned ${a.size} unique ports.`,timestamp:((l=n[0])==null?void 0:l.timestamp)||Date.now()})}),e}}function gg(t,n){const e=document.getElementById(n);if(!e)return;e.innerHTML="";const r=e.clientWidth,i=e.clientHeight,o=ot(e).append("svg").attr("width",r).attr("height",i).style("background","radial-gradient(circle at center, #0f172a 0%, #020617 100%)"),a=mh().scale(i/2.5).translate([r/2,i/2]).clipAngle(90),s=rh().projection(a),l=o.append("g");l.append("path").datum({type:"Sphere"}).attr("d",s).attr("fill","rgba(15, 23, 42, 0.5)").attr("stroke","var(--accent-cyan)").attr("stroke-width",1).attr("opacity",.5);const u=Zf();l.append("path").datum(u()).attr("d",s).attr("fill","none").attr("stroke","var(--accent-cyan)").attr("stroke-width",.5).attr("stroke-opacity",.2);function c(p){if(!p)return[0,0];const m=p.split(".").map(Number);if(m.length!==4)return[0,0];const w=(m[0]*m[1]+m[2])%360-180,v=(m[1]*m[3]+m[0])%180-90;return[w,v]}const g=[],f=Math.min(t.length,1e3);for(let p=0;p<f;p++){const m=t[p];m.ip&&g.push({source:c(m.ip.src),target:c(m.ip.dst),proto:m.tcp?"tcp":"udp"})}l.selectAll(".link").data(g).enter().append("path").attr("class","link").attr("d",p=>s({type:"LineString",coordinates:[p.source,p.target]})).attr("fill","none").attr("stroke",p=>p.proto==="tcp"?"var(--accent-blue)":"var(--accent-warn)").attr("stroke-width",1).attr("stroke-opacity",.3);const h=g.flatMap(p=>[p.source,p.target]);l.selectAll(".node").data(h).enter().append("circle").attr("cx",p=>a(p)[0]).attr("cy",p=>a(p)[1]).attr("r",2).attr("fill","var(--accent-cyan)").attr("opacity",.6);let y=[0,0];const x=[.02,0];We(p=>{y[0]+=x[0]*10,a.rotate(y),l.selectAll("path").attr("d",s),l.selectAll("circle").attr("cx",m=>{const w=a(m);return w?w[0]:-10}).attr("cy",m=>{const w=a(m);return w?w[1]:-10}).attr("display",m=>"block")})}let Zr="graph";console.log("EtherPrism Nexus Initializing...");const Wt=document.getElementById("drop-zone"),za=document.getElementById("file-input"),dg=document.getElementById("btn-import"),pg=document.getElementById("btn-close-details"),ko=document.getElementById("details-panel"),ce=document.getElementById("app-status"),La=document.getElementById("stream-modal"),$o=document.getElementById("btn-close-stream"),Pn=document.getElementById("btn-tab-ascii"),Un=document.getElementById("btn-tab-html"),mi=document.getElementById("stream-content"),mg="stevens-graph-container",Gr=document.getElementById("btn-view-graph"),Or=document.getElementById("btn-view-list"),Ye=document.getElementById("btn-view-map");rt.getPackets();it.on("status:updated",t=>{const n=ce.querySelector(".status-dot"),e=ce.childNodes[1];e&&(e.textContent=` ${t}`),t.includes("Reading")||t.includes("Processing")?(ce.classList.add("processing"),n.style.color="var(--accent-cyan)"):(ce.classList.remove("processing"),n.style.color="var(--accent-success)")});it.on("state:updated",({key:t,value:n})=>{t==="isProcessing"&&n&&Wt.classList.add("hidden")});it.on("data:loaded",t=>{Wt.classList.add("hidden"),Kn()});it.on("selection:changed",t=>{t?(ko.classList.remove("collapsed"),xg(t)):ko.classList.add("collapsed")});it.on("view:updated",()=>{Kn()});it.on("filter:time",()=>Kn());it.on("filter:search",()=>Kn());window.addEventListener("packet-selected",t=>{rt.updateSelection("packet",t.detail)});let Gn=null;$o&&$o.addEventListener("click",()=>{La.classList.add("hidden")});Pn&&Pn.addEventListener("click",()=>{Pn.classList.add("active"),Un.classList.remove("active"),Gn&&(mi.textContent=Gn.text)});Un&&Un.addEventListener("click",()=>{Un.classList.add("active"),Pn.classList.remove("active"),Gn&&(mi.innerHTML=Gn.html)});function yg(t){try{const n=rt.getPackets(),e=lg.followTcpStream(t,n);Gn=e,Pn.classList.add("active"),Un.classList.remove("active"),mi.textContent=e.text,La.classList.remove("hidden"),setTimeout(()=>{fg(e,mg)},100)}catch(n){console.error(n),alert("Stream Analysis Failed: "+n.message)}}Gr.addEventListener("click",()=>yi("graph"));Or.addEventListener("click",()=>yi("list"));Ye&&Ye.addEventListener("click",()=>yi("map"));function yi(t){Zr=t,[Gr,Or,Ye].forEach(e=>{e&&(e.classList.remove("active"),e.style.opacity="0.7",e.style.background="transparent")});let n;t==="graph"?n=Gr:t==="list"?n=Or:t==="map"&&(n=Ye),n&&(n.classList.add("active"),n.style.opacity="1",n.style.background="rgba(34, 211, 238, 0.1)"),Kn()}dg.addEventListener("click",()=>za.click());za.addEventListener("change",t=>Fa(t.target.files[0]));window.addEventListener("dragover",t=>{t.preventDefault(),t.stopPropagation()});window.addEventListener("drop",t=>{t.preventDefault(),t.stopPropagation()});Wt.addEventListener("dragover",t=>{t.dataTransfer.dropEffect="copy",Wt.style.background="rgba(34, 211, 238, 0.1)"});Wt.addEventListener("dragleave",()=>{Wt.style.background=""});Wt.addEventListener("drop",t=>{Wt.style.background="";const n=t.dataTransfer.files;n.length&&Fa(n[0])});document.getElementById("search-input").addEventListener("input",t=>{rt.updateSearch(t.target.value)});pg.addEventListener("click",()=>{rt.updateSelection(null,null)});async function Fa(t){if(t){rt.setFile(t);try{const n=await vg(t),e=new URL("data:text/javascript;base64,aW1wb3J0IHsgUGNhcFBhcnNlciB9IGZyb20gJy4uL3BhcnNlci9wY2FwLmpzJzsNCmltcG9ydCB7IFByb3RvY29sUGFyc2VyIH0gZnJvbSAnLi4vcGFyc2VyL3Byb3RvY29sLmpzJzsNCg0Kc2VsZi5vbm1lc3NhZ2UgPSBhc3luYyAoZSkgPT4gew0KICAgIGNvbnN0IHsgYnVmZmVyIH0gPSBlLmRhdGE7DQoNCiAgICB0cnkgew0KICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgdHlwZTogJ3N0YXR1cycsIG1lc3NhZ2U6ICdQYXJzaW5nIEdsb2JhbCBIZWFkZXIuLi4nIH0pOw0KDQogICAgICAgIGNvbnN0IHBjYXAgPSBuZXcgUGNhcFBhcnNlcihidWZmZXIpOw0KICAgICAgICAvLyBXZSB3aWxsIG1hbnVhbGx5IGl0ZXJhdGUgdG8gcmVwb3J0IHByb2dyZXNzIGluc3RlYWQgb2YgY2FsbGluZyBwYXJzZSgpIGFsbCBhdCBvbmNlDQogICAgICAgIHBjYXAucGFyc2VHbG9iYWxIZWFkZXIoKTsNCg0KICAgICAgICBjb25zdCBwYWNrZXRzID0gW107DQogICAgICAgIGNvbnN0IHRvdGFsU2l6ZSA9IGJ1ZmZlci5ieXRlTGVuZ3RoOw0KICAgICAgICBsZXQgbGFzdFJlcG9ydCA9IERhdGUubm93KCk7DQoNCiAgICAgICAgd2hpbGUgKHBjYXAub2Zmc2V0IDwgcGNhcC5idWZmZXIuYnl0ZUxlbmd0aCkgew0KICAgICAgICAgICAgY29uc3QgcmF3ID0gcGNhcC5wYXJzZVBhY2tldCgpOw0KICAgICAgICAgICAgaWYgKCFyYXcpIGJyZWFrOw0KDQogICAgICAgICAgICBjb25zdCBkZWNvZGVkID0gUHJvdG9jb2xQYXJzZXIucGFyc2UocmF3LmRhdGEpOw0KICAgICAgICAgICAgcGFja2V0cy5wdXNoKHsgLi4ucmF3LCAuLi5kZWNvZGVkIH0pOw0KDQogICAgICAgICAgICAvLyBSZXBvcnQgcHJvZ3Jlc3MgZXZlcnkgMjAwbXMNCiAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gbGFzdFJlcG9ydCA+IDIwMCkgew0KICAgICAgICAgICAgICAgIGNvbnN0IHByb2dyZXNzID0gKHBjYXAub2Zmc2V0IC8gdG90YWxTaXplKSAqIDEwMDsNCiAgICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3Byb2dyZXNzJywNCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHByb2dyZXNzLA0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBgUGFyc2luZy4uLiAke3Byb2dyZXNzLnRvRml4ZWQoMSl9JWANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0UmVwb3J0ID0gRGF0ZS5ub3coKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgICAgdHlwZTogJ2NvbXBsZXRlJywNCiAgICAgICAgICAgIHBhY2tldHM6IHBhY2tldHMNCiAgICAgICAgfSk7DQoNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7IHR5cGU6ICdlcnJvcicsIGVycm9yOiBlcnIubWVzc2FnZSB9KTsNCiAgICB9DQp9Ow0K",import.meta.url),r=new Worker(e,{type:"module"});r.postMessage({buffer:n},[n]),r.onmessage=i=>{const{type:o,packets:a,message:s}=i.data;o==="status"||o==="progress"?it.emit("status:updated",s):o==="complete"?(rt.setPackets(a),r.terminate()):o==="error"&&(console.error(i.data.error),it.emit("status:updated","Error: "+i.data.error),r.terminate())}}catch(n){console.error(n),it.emit("status:updated","Error loading file")}}}function vg(t){return new Promise((n,e)=>{const r=new FileReader;r.onload=()=>n(r.result),r.onerror=e,r.readAsArrayBuffer(t)})}function Kn(){const t=rt.getPackets();if(t.length===0)return;let n=t;rt.state.filter.timeStart&&(n=n.filter(i=>i.timestamp>=rt.state.filter.timeStart&&i.timestamp<=rt.state.filter.timeEnd));const e=rt.state.filter.searchTerm?rt.state.filter.searchTerm.toLowerCase():"";e&&(n=n.filter(i=>{var u,c;const o=((u=i.ip)==null?void 0:u.src)||"",a=((c=i.ip)==null?void 0:c.dst)||"",s=i.tcp?"tcp":i.udp?"udp":i.icmp?"icmp":"";if(o.includes(e)||a.includes(e)||s.includes(e))return!0;let l="";return i.app&&(l=i.app.info),!!(l&&l.toLowerCase().includes(e))}));const r=hg.scan(n);if(Zr==="graph"){const i=rt.getFlows().filter(o=>rt.getHiddenNodes().has(o.source)||rt.getHiddenNodes().has(o.target)?!1:e?o.source.includes(e)||o.target.includes(e):!0);J0(i,"visualization-container",(o,a)=>rt.updateSelection(o,a),o=>rt.hideNode(o))}else Zr==="map"?gg(n,"visualization-container"):ag(n,"visualization-container",t);ug(n,"timeline-container",(i,o)=>{rt.updateTimeFilter(i,o)}),wg(n,r)}function wg(t,n=[]){t||(t=rt.getPackets());const e=document.getElementById("sidebar-stats");let r=0;t.forEach(a=>{a.tcp&&r++,a.udp});const i=rt.getFlows().length;let o="";n&&n.length>0&&(o=`
            <div class="glass-panel" style="margin-top:1rem; border-color:var(--accent-warn);">
                <div style="font-size:0.8rem; color:var(--accent-warn); font-weight:700; margin-bottom:5px;">THREATS DETECTED (${n.length})</div>
                <div style="max-height:150px; overflow:auto; font-size:0.75rem;">
                    ${n.map(a=>`<div style="margin-bottom:4px; padding-bottom:4px; border-bottom:1px solid rgba(255,255,255,0.1); color:var(--text-secondary);">
                        <span style="color:var(--accent-danger)">${a.type}</span><br>
                        Src: ${a.source}
                    </div>`).join("")}
                </div>
            </div>
        `),e.innerHTML=`
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; text-align:center;">
            <div class="glass-panel" style="padding:10px;">
                <div style="font-size:1.5rem; color:var(--text-primary); font-weight:700;">${t.length.toLocaleString()}</div>
                <div style="font-size:0.7rem; color:var(--text-secondary);">PACKETS</div>
            </div>
            <div class="glass-panel" style="padding:10px;">
                <div style="font-size:1.5rem; color:var(--accent-blue); font-weight:700;">${i.toLocaleString()}</div>
                <div style="font-size:0.7rem; color:var(--text-secondary);">TOTAL FLOWS</div>
            </div>
        </div>
        
        <div class="glass-panel" style="margin-top:1rem;">
             <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                <span style="font-size:0.8rem; color:var(--text-secondary);">TCP Traffic</span>
                <span style="font-size:0.8rem; color:var(--accent-cyan);">${Math.round(r/(t.length||1)*100)}%</span>
             </div>
             <div style="width:100%; height:4px; background:rgba(255,255,255,0.1); border-radius:2px; overflow:hidden;">
                <div style="width:${Math.round(r/(t.length||1)*100)}%; height:100%; background:var(--accent-cyan);"></div>
             </div>
        </div>

        ${o}
    `}function xg(t){const n=document.getElementById("details-content");if(!t){n.innerHTML="";return}if(t.type==="node"){const e=t.data.id,r=rt.getHostnames().get(e)||"Unknown Host";n.innerHTML=`
            <div style="font-size:1.2rem; margin-bottom:0.5rem; color:white; font-family:var(--font-mono);">${e}</div>
            <div style="color:var(--accent-magenta); font-size:0.9rem; margin-bottom:1rem;">${r}</div>
            <div class="glass-panel">
                <div style="font-size:0.8rem; color:var(--text-secondary); margin-bottom:5px;">Role</div>
                <div style="font-family:var(--font-mono); color:var(--accent-cyan);">${t.data.type.toUpperCase()}</div>
            </div>
             <div class="glass-panel">
                <div style="font-size:0.8rem; color:var(--text-secondary); margin-bottom:5px;">Traffic</div>
                <div>Sent: ${t.data.value} bytes</div>
                <div>Connections: ${t.data.connections}</div>
            </div>
        `}else if(t.type==="link")n.innerHTML=`
            <div style="font-size:1rem; margin-bottom:0.5rem; color:white;">Connection Details</div>
            <div style="color:var(--text-secondary); font-size:0.8rem; font-family:var(--font-mono);">
                ${t.data.source.id} <br/>  <br/> ${t.data.target.id}
            </div>
        `;else if(t.type==="packet"){const e=t.data;let r="";e.tcp&&(r='<button id="btn-follow" class="btn-neon" style="width:100%; margin-bottom:1rem;">Follow Stream</button>'),n.innerHTML=`
            <div style="font-size:1rem; margin-bottom:0.5rem; color:white;">Packet #${e.index!==void 0?e.index+1:"?"}</div>
            ${r}
            <div class="glass-panel" style="font-family:var(--font-mono); font-size:0.8rem; overflow:auto;">
                 <div id="hex-view-container">Loading Hex...</div>
            </div>
            <!-- Raw JSON fallback -->
             <div class="glass-panel" style="font-family:var(--font-mono); font-size:0.7rem; margin-top:10px; opacity:0.6;">
                 <pre style="margin:0;">${JSON.stringify(e,null,2)}</pre>
            </div>
        `;const i=n.querySelector("#hex-view-container");i&&ig(e,i);const o=n.querySelector("#btn-follow");o&&o.addEventListener("click",()=>yg(e))}}
